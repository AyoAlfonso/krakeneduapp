{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport h from 'react-hyperscript';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nimport { getTemplatesQuery } from 'pages/api/courses/[id]/templates';\nimport { Box, Seperator, FormBox, LabelBox } from 'components/Layout';\nimport { Secondary, Primary, BackButton } from 'components/Button';\nimport { useState, Fragment } from 'react';\nimport { Input } from 'components/Form';\nimport EditorWithPreview from 'components/EditorWithPreview';\nimport { PageLoader } from 'components/Loader';\nimport { useApi } from 'src/apiHelpers';\nimport { Modal } from 'components/Modal';\nimport { DISCOURSE_URL } from 'src/constants';\nimport { useFormData } from 'src/hooks';\nexport default CohortTemplatesPages;\n\nfunction CohortTemplatesPages(props) {\n  var _props$templates, _props$templates2;\n\n  let router = useRouter();\n  let template = (_props$templates = props.templates) === null || _props$templates === void 0 ? void 0 : _props$templates.find(t => t.name === router.query.template);\n  if (!props.templates) return h(PageLoader);\n  if (template) return h(Box, {\n    gap: 64\n  }, [h(Box, {\n    gap: 16\n  }, [h(BackButton, {\n    href: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}/templates`,\n    shallow: true\n  }, 'Templates'), h('h1', \"Post template\")]), h(TemplatePage, {\n    template\n  })]);\n  return h(Box, {\n    width: 640,\n    gap: 32\n  }, [h(Box, {\n    gap: 16\n  }, [h(BackButton, {\n    href: \"/courses/[slug]/[id]/cohorts/[cohortId]\",\n    as: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}`\n  }, 'Cohort Details'), h('h1', \"Templates\"), h('p.big', [`Use templates to easily post new topics in your cohort forum! You can create new templates in the `, h(Link, {\n    href: '/courses/[slug]/[id]/settings',\n    as: `/courses/${router.query.slug}/${router.query.id}/settings`\n  }, h('a', 'course settings')), `.`])]), h(Box, {}, (_props$templates2 = props.templates) === null || _props$templates2 === void 0 ? void 0 : _props$templates2.filter(t => t.type === 'triggered').sort((a, b) => a.name > b.name ? 1 : -1).flatMap(template => {\n    return [h(Box, {\n      h: true,\n      style: {\n        gridAutoColumns: 'auto'\n      }\n    }, [h('div', [h('h3', template.name), h('span.textSecondary', template.type === 'prepopulated' ? \"Prepopulated for all cohorts\" : \"Manually published by facilitator\")]), h(Box, {\n      h: true,\n      style: {\n        justifySelf: 'end',\n        alignItems: 'center'\n      }\n    }, [h(Link, {\n      href: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}/templates` + '?template=' + template.name,\n      shallow: true\n    }, h(Secondary, 'Use'))])]), h(Seperator)];\n  }).slice(0, -1))]);\n}\n\nfunction TemplatePage(props) {\n  let {\n    form,\n    changed,\n    reset\n  } = useFormData(props.template);\n  let {\n    0: post,\n    1: setPost\n  } = useState();\n  let [status, callPost] = useApi([]);\n  let router = useRouter();\n\n  let onSubmit = async e => {\n    e.preventDefault();\n    let res = await callPost(`/api/cohorts/${router.query.cohortId}/postTopic`, {\n      title: form.title.value,\n      body: form.content.value,\n      tags: []\n    });\n    if (res.status === 200) setPost(res.result.topic.topic_id);\n  };\n\n  return h(Fragment, [post && status === 'success' ? h(Modal, {\n    display: !!post,\n    onExit: () => {\n      setPost(undefined);\n    }\n  }, h(Box, {\n    gap: 32\n  }, [h(Box, {\n    gap: 16,\n    style: {\n      textAlign: 'center'\n    }\n  }, [h('h1', \"Cool!\"), h('p', \"Your topic has been added\")]), h(Box, [h('a', {\n    style: {\n      justifySelf: \"center\"\n    },\n    href: `${DISCOURSE_URL}/t/${post}`\n  }, h(Primary, \"View it here\")), h(Link, {\n    href: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}/templates`\n  }, h('a', {\n    style: {\n      justifySelf: \"center\"\n    }\n  }, h(Secondary, 'Back to Templates')))])])) : null, h(FormBox, {\n    onSubmit,\n    gap: 32\n  }, [h(LabelBox, {\n    width: 400\n  }, [h('h4', \"Title\"), h(Input, _objectSpread({\n    type: 'text',\n    name: 'title'\n  }, form.title))]), h(LabelBox, [h('h4', \"Body\"), h(EditorWithPreview, form.content)]), h(Box, {\n    h: true,\n    style: {\n      justifySelf: 'right'\n    }\n  }, [h(Secondary, {\n    disabled: !changed,\n    onClick: () => reset()\n  }, \"Reset Template\"), h(Primary, {\n    type: 'submit',\n    status\n  }, \"Post to the forum\")])])]);\n}\n\nexport const getStaticProps = async ctx => {\n  var _ctx$params, _ctx$params2;\n\n  let cohortNum = ((_ctx$params = ctx.params) === null || _ctx$params === void 0 ? void 0 : _ctx$params.cohortId) || '';\n  let courseId = parseInt(((_ctx$params2 = ctx.params) === null || _ctx$params2 === void 0 ? void 0 : _ctx$params2.id) || '');\n  let templates = await getTemplatesQuery(courseId);\n  return {\n    props: {\n      templates,\n      courseId,\n      cohortNum\n    }\n  };\n};\nexport const getStaticPaths = async () => {\n  return {\n    paths: [],\n    fallback: true\n  };\n};","map":{"version":3,"sources":["/Users/ayooluwaalfonso/code/krakeneduapp/pages/courses/[slug]/[id]/cohorts/[cohortId]/templates.ts"],"names":["h","Link","useRouter","getTemplatesQuery","Box","Seperator","FormBox","LabelBox","Secondary","Primary","BackButton","useState","Fragment","Input","EditorWithPreview","PageLoader","useApi","Modal","DISCOURSE_URL","useFormData","CohortTemplatesPages","props","router","template","templates","find","t","name","query","gap","href","slug","id","cohortId","shallow","TemplatePage","width","as","filter","type","sort","a","b","flatMap","style","gridAutoColumns","justifySelf","alignItems","slice","form","changed","reset","post","setPost","status","callPost","onSubmit","e","preventDefault","res","title","value","body","content","tags","result","topic","topic_id","display","onExit","undefined","textAlign","disabled","onClick","getStaticProps","ctx","cohortNum","params","courseId","parseInt","getStaticPaths","paths","fallback"],"mappings":"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","sourcesContent":["import h from 'react-hyperscript'\nimport Link from 'next/link'\nimport { useRouter } from 'next/router'\nimport { getTemplatesQuery } from 'pages/api/courses/[id]/templates'\nimport { InferGetStaticPropsType } from 'next'\nimport { Box, Seperator, FormBox, LabelBox } from 'components/Layout'\nimport { Secondary, Primary, BackButton } from 'components/Button'\nimport { useState, Fragment } from 'react'\nimport { Input } from 'components/Form'\nimport EditorWithPreview from 'components/EditorWithPreview'\nimport { PageLoader } from 'components/Loader'\nimport { useApi } from 'src/apiHelpers'\nimport { PostTopicMsg, PostTopicResponse } from 'pages/api/cohorts/[cohortId]/postTopic'\nimport { Modal } from 'components/Modal'\nimport { DISCOURSE_URL } from 'src/constants'\nimport { useFormData } from 'src/hooks'\n\nexport default CohortTemplatesPages\ntype Props = InferGetStaticPropsType<typeof getStaticProps>\nfunction CohortTemplatesPages(props:Props) {\n  let router = useRouter()\n  let template = props.templates?.find(t=> t.name === router.query.template)\n  if(!props.templates) return h(PageLoader)\n\n  if(template) return h(Box, {gap: 64}, [\n    h(Box, {gap:16}, [\n      h(BackButton, {href: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}/templates`, shallow:true}, 'Templates'),\n      h('h1', \"Post template\")\n    ]),\n    h(TemplatePage, {template})\n  ])\n\n  return h(Box, {width: 640, gap: 32},[\n    h(Box, {gap:16}, [\n      h(BackButton, {href: \"/courses/[slug]/[id]/cohorts/[cohortId]\", as: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}`}, 'Cohort Details'),\n      h('h1', \"Templates\"),\n      h('p.big', [\n        `Use templates to easily post new topics in your cohort forum! You can create new templates in the `,\n        h(Link, {href: '/courses/[slug]/[id]/settings', as:`/courses/${router.query.slug}/${router.query.id}/settings`}, h('a', 'course settings')), `.`\n      ])\n    ]),\n    h(Box, {}, props.templates\n      ?.filter(t=>t.type === 'triggered')\n      .sort((a, b)=>  a.name > b.name ? 1 : -1)\n      .flatMap(template => {\n        return [\n          h(Box, {h: true, style: {gridAutoColumns: 'auto'}},[\n            h('div', [\n              h('h3', template.name),\n              h('span.textSecondary', template.type ==='prepopulated' ? \"Prepopulated for all cohorts\" : \"Manually published by facilitator\")\n            ]),\n            h(Box, {h: true, style:{justifySelf: 'end', alignItems: 'center'}}, [\n              h(Link, {\n                href: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}/templates`+'?template='+template.name,\n                shallow: true,\n              }, h(Secondary, 'Use'))\n            ])\n          ]),\n          h(Seperator)\n        ]}).slice(0, -1))\n  ])\n}\n\nfunction TemplatePage(props: {template: Props['templates'][0]}) {\n  let {form, changed, reset} = useFormData(props.template)\n  let [post, setPost] = useState<number | undefined>()\n  let [status, callPost] = useApi<PostTopicMsg, PostTopicResponse>([])\n  let router = useRouter()\n\n  let onSubmit = async (e:React.FormEvent)=>{\n    e.preventDefault()\n    let res = await callPost(`/api/cohorts/${router.query.cohortId}/postTopic`, {title: form.title.value, body: form.content.value, tags:[]})\n    if(res.status===200) setPost(res.result.topic.topic_id)\n  }\n\n  return h(Fragment, [\n    post && status === 'success' ? h(Modal, {display: !!post, onExit: ()=>{setPost(undefined)}}, h(Box, {gap:32},[\n      h(Box, {gap:16, style:{textAlign: 'center'}}, [\n      h('h1', \"Cool!\"),\n        h('p', \"Your topic has been added\")\n      ]),\n      h(Box, [\n        h('a', {style:{justifySelf:\"center\"}, href: `${DISCOURSE_URL}/t/${post}`}, h(Primary, \"View it here\")),\n      h(Link, {\n        href: `/courses/${router.query.slug}/${router.query.id}/cohorts/${router.query.cohortId}/templates`\n      }, h('a', {style:{justifySelf:\"center\"}}, h(Secondary, 'Back to Templates')))\n      ])\n    ])) : null,\n    h(FormBox, {onSubmit, gap:32}, [\n      h(LabelBox, {width: 400}, [\n        h('h4', \"Title\"),\n        h(Input, {\n          type: 'text',\n          name: 'title',\n          ...form.title,\n        })\n      ]),\n      h(LabelBox, [\n        h('h4', \"Body\"),\n        h(EditorWithPreview, form.content)\n      ]),\n      h(Box, {h:true, style:{justifySelf: 'right'}}, [\n        h(Secondary, {disabled: !changed, onClick:()=>reset()}, \"Reset Template\"),\n        h(Primary, {type: 'submit', status}, \"Post to the forum\"),\n      ])\n    ])\n  ])\n}\n\nexport const getStaticProps = async (ctx:any)=>{\n  let cohortNum = (ctx.params?.cohortId || '' )as string\n  let courseId = parseInt(ctx.params?.id as string || '')\n\n  let templates = await getTemplatesQuery(courseId)\n  return {props: {templates, courseId, cohortNum}}\n}\n\nexport const getStaticPaths = async ()=>{\n  return {paths:[], fallback: true}\n}\n"]},"metadata":{},"sourceType":"module"}