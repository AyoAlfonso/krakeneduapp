{"ast":null,"code":"import _defineProperty from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport h from 'react-hyperscript';\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport Link from 'next/link';\nimport { Box, FormBox, LabelBox } from 'components/Layout';\nimport { Primary } from 'components/Button';\nimport { Error, PasswordInput } from 'components/Form';\nimport { useApi } from 'src/apiHelpers';\nvar COPY = {\n  header: \"Reset Password\",\n  button: \"Reset Password\",\n  passwordInput: \"New Password\",\n  confirmInput: \"Confirm Password\",\n  error: h(Error, ['Looks like that link is expired or invalid, please try to ', h(Link, {\n    href: \"/login?reset\"\n  }, h('a', 'reset your password')), ' again'])\n};\n\nvar ResetPassword = function ResetPassword() {\n  var _useState = useState({\n    password: '',\n    confirmPassword: ''\n  }),\n      formData = _useState[0],\n      setFormData = _useState[1];\n\n  var _useApi = useApi([formData]),\n      _useApi2 = _slicedToArray(_useApi, 2),\n      status = _useApi2[0],\n      callResetPassword = _useApi2[1];\n\n  var router = useRouter();\n  var key = router.query.key;\n  useEffect(function () {\n    if (status === 'success') {\n      setTimeout(function () {\n        router.push('/login');\n      }, 3500);\n    }\n  });\n  if (!key || typeof key !== 'string') return COPY.error;\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              _context.next = 3;\n              return callResetPassword('/api/user/resetPassword/reset', {\n                key: key,\n                password: formData.password\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  switch (status) {\n    case 'normal':\n    case 'loading':\n      return h(FormBox, {\n        onSubmit: onSubmit,\n        width: 400,\n        ma: true\n      }, [h('h1', COPY.header), h(LabelBox, {\n        gap: 8\n      }, [h('div', [h('h4', COPY.passwordInput), h('small.textSecondary', \"Minimum length 8 characters\")]), h(PasswordInput, {\n        type: 'password',\n        minLength: 8,\n        value: formData.password,\n        onChange: function onChange(e) {\n          return setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n            password: e.target.value\n          }));\n        }\n      })]), h(Primary, {\n        type: 'submit',\n        status: status,\n        style: {\n          justifySelf: 'end'\n        }\n      }, 'Submit')]);\n\n    case 'success':\n      return h(Box, [h('h1', \"Great\"), h('p', 'You can now log in with your new password'), h(Link, {\n        href: '/login'\n      }, h('a', h(Primary, 'Log In')))]);\n\n    case 'error':\n      return COPY.error;\n  }\n};\n\nexport default ResetPassword;","map":{"version":3,"sources":["/Users/ayooluwaalfonso/code/krakeneduapp/pages/resetPassword.ts"],"names":["h","useState","useEffect","useRouter","Link","Box","FormBox","LabelBox","Primary","Error","PasswordInput","useApi","COPY","header","button","passwordInput","confirmInput","error","href","ResetPassword","password","confirmPassword","formData","setFormData","status","callResetPassword","router","key","query","setTimeout","push","onSubmit","e","preventDefault","width","ma","gap","type","minLength","value","onChange","target","style","justifySelf"],"mappings":"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","sourcesContent":["import h from 'react-hyperscript'\nimport { useState, useEffect } from 'react'\nimport {useRouter} from 'next/router'\nimport Link from 'next/link'\n\nimport { Box, FormBox, LabelBox} from 'components/Layout'\nimport {Primary} from 'components/Button'\nimport { Error, PasswordInput} from 'components/Form'\nimport {ResetMsg, ResetResult} from 'pages/api/user/resetPassword/[action]'\nimport { useApi } from 'src/apiHelpers'\n\nconst COPY = {\n  header: \"Reset Password\",\n  button: \"Reset Password\",\n  passwordInput: \"New Password\",\n  confirmInput: \"Confirm Password\",\n  error: h(Error, [\n    'Looks like that link is expired or invalid, please try to ', h(Link, {href:\"/login?reset\"}, h('a', 'reset your password')),\n    ' again'\n  ])\n}\n\nconst ResetPassword = ()=>{\n  let [formData, setFormData] = useState({password:'', confirmPassword: ''})\n  let [status, callResetPassword] = useApi<ResetMsg, ResetResult>([formData])\n  let router = useRouter()\n  let key = router.query.key as string\n\n  useEffect(()=>{\n    if(status === 'success') {\n      setTimeout(()=> {\n        router.push('/login')\n      }, 3500)\n    }\n  })\n\n  if(!key || typeof key !== 'string') return COPY.error\n\n  const onSubmit = async (e:React.FormEvent)=> {\n    e.preventDefault()\n    await callResetPassword('/api/user/resetPassword/reset', {key, password: formData.password})\n  }\n\n  switch(status) {\n    case 'normal':\n    case 'loading':\n      return h(FormBox, {onSubmit, width:400, ma: true }, [\n        h('h1', COPY.header),\n        h(LabelBox, {gap: 8}, [\n          h('div',[\n            h('h4', COPY.passwordInput),\n            h('small.textSecondary', \"Minimum length 8 characters\"),\n          ]),\n          h(PasswordInput, {\n            type: 'password',\n            minLength: 8,\n            value: formData.password,\n            onChange: e => setFormData({...formData, password:e.target.value})\n          }),\n        ]),\n        h(Primary, {type: 'submit', status, style: {justifySelf:'end'}}, 'Submit')\n      ])\n    case 'success': return h(Box, [\n      h('h1', \"Great\"),\n      h('p', 'You can now log in with your new password'),\n      h(Link, {href:'/login'}, h('a', h(Primary, 'Log In')))\n    ])\n    case 'error': return COPY.error\n  }\n}\n\nexport default ResetPassword\n"]},"metadata":{},"sourceType":"module"}