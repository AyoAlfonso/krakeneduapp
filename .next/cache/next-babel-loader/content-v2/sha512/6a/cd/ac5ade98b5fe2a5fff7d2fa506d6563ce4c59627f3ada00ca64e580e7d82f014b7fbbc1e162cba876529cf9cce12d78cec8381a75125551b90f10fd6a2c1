{"ast":null,"code":"import _defineProperty from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/ayooluwaalfonso/code/krakeneduapp/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _styled from \"@emotion/styled-base\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nimport h from 'react-hyperscript';\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport Link from 'next/link';\nimport { Box, LabelBox, FormBox } from 'components/Layout';\nimport { Input, Error, Info } from 'components/Form';\nimport { Primary } from 'components/Button';\nimport { AccentImg, HalfLoopImg } from 'components/Images';\nimport { useApi } from 'src/apiHelpers';\nimport { useUserData } from 'src/data';\nvar COPY = {\n  emailOrUsernameInput: \"Email or Username\",\n  passwordInput: \"Password\",\n  resetPassword: \"Reset password\",\n  loginHeader: \"Log In\",\n  wrongLogin: h('div', [\"The email/username and password don't match\", h('br'), \"If you want, you can \", h(Link, {\n    href: '/login?reset'\n  }, h('a', 'reset your password here')), '.']),\n  loginButton: \"Log In\"\n};\n\nvar Login = function Login() {\n  var router = useRouter();\n\n  var _useState = useState({\n    emailOrUsername: '',\n    password: ''\n  }),\n      formData = _useState[0],\n      setFormData = _useState[1];\n\n  var redirect = router.query.redirect;\n  var reset = router.query.reset;\n\n  var _useUserData = useUserData(),\n      data = _useUserData.data,\n      mutate = _useUserData.mutate;\n\n  var _useApi = useApi([formData], /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(result) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!redirect) {\n                _context.next = 9;\n                break;\n              }\n\n              if (!(redirect[0] !== '/' || redirect.startsWith('/sso'))) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt(\"return\", window.location.assign(redirect));\n\n            case 3:\n              _context.next = 5;\n              return mutate(result);\n\n            case 5:\n              _context.next = 7;\n              return router.push(redirect);\n\n            case 7:\n              _context.next = 11;\n              break;\n\n            case 9:\n              _context.next = 11;\n              return router.push('/dashboard');\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }()),\n      _useApi2 = _slicedToArray(_useApi, 2),\n      status = _useApi2[0],\n      callLogin = _useApi2[1];\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              callLogin('/api/login', formData);\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function onSubmit(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (data) router.push(redirect || '/dashboard');\n  }, [data]);\n  if (typeof reset !== 'undefined') return h(ResetPassword);\n  return h(FormBox, {\n    onSubmit: onSubmit,\n    width: 400,\n    ma: true,\n    gap: 32\n  }, [h(Box, [h(LoginHeader, [h('h1', COPY.loginHeader), h(HalfLoopImg, {\n    src1: '/img/door-1.gif',\n    src2: '/img/door-2.gif',\n    alt: \"an animated gif of a entrance to the sparkle void\",\n    startLoop: 1200\n  })]), h('p.textSecondary', ['Or ', h(Link, {\n    href: '/signup'\n  }, h('a', 'sign up')), ' for a new account'])]), status === 'error' ? h(Error, {}, COPY.wrongLogin) : null, h(LabelBox, {\n    gap: 8\n  }, [h('h4', COPY.emailOrUsernameInput), h(Input, {\n    type: 'text',\n    value: formData.emailOrUsername,\n    required: true,\n    onChange: function onChange(e) {\n      return setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n        emailOrUsername: e.currentTarget.value\n      }));\n    }\n  })]), h(LabelBox, {\n    gap: 8\n  }, [h('h4', COPY.passwordInput), h(Input, {\n    type: 'password',\n    value: formData.password,\n    required: true,\n    onChange: function onChange(e) {\n      return setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n        password: e.currentTarget.value\n      }));\n    }\n  }), h(Link, {\n    href: '/login?reset'\n  }, h('a', {\n    style: {\n      justifySelf: \"right\"\n    }\n  }, COPY.resetPassword))]), h(Primary, {\n    type: 'submit',\n    status: status,\n    style: {\n      justifySelf: \"right\"\n    }\n  }, COPY.loginButton)]);\n};\n\nvar RESETCOPY = {\n  header: \"Reset Password\",\n  emailInput: \"Your account email\",\n  button: \"Reset Password\",\n  successHeader: \"Check your Email\"\n};\n\nvar ResetPassword = function ResetPassword() {\n  var _useState2 = useState(''),\n      email = _useState2[0],\n      setEmail = _useState2[1];\n\n  var _useApi3 = useApi([email]),\n      _useApi4 = _slicedToArray(_useApi3, 3),\n      status = _useApi4[0],\n      callResetPassword = _useApi4[1],\n      setStatus = _useApi4[2];\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              e.preventDefault();\n              _context3.next = 3;\n              return callResetPassword('/api/user/resetPassword/request', {\n                email: email\n              });\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function onSubmit(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  switch (status) {\n    case 'normal':\n    case 'loading':\n      return h(FormBox, {\n        onSubmit: onSubmit,\n        width: 400,\n        ma: true\n      }, [h('h1', RESETCOPY.header), h(LabelBox, {\n        gap: 16\n      }, [h('h4', RESETCOPY.emailInput), h(Input, {\n        type: 'email',\n        required: true,\n        value: email,\n        onChange: function onChange(e) {\n          return setEmail(e.currentTarget.value);\n        }\n      })]), h('div', {\n        style: {\n          display: 'grid',\n          justifyItems: 'end',\n          gridGap: '8px'\n        }\n      }, [h(Primary, {\n        type: 'submit',\n        status: status\n      }, RESETCOPY.button)])]);\n\n    case 'success':\n      return h(Box, {\n        gap: 16,\n        width: 400,\n        ma: true\n      }, [h(AccentImg, {\n        src: '/img/plane.gif',\n        alt: \"an animated gif of a paper airplane taking off\"\n      }), h('h1', RESETCOPY.successHeader), 'We sent an email with a password reset link to', h(Info, email), 'It expires in 30 minutes.', h('br'), h(Primary, {\n        style: {\n          width: '100%'\n        },\n        onClick: function onClick() {\n          return setStatus('normal');\n        }\n      }, 'Send another link')]);\n\n    case 'error':\n      return h(Box, {\n        width: 400,\n        ma: true\n      }, [h(Error, 'something went wrong, please refresh and try again')]);\n  }\n};\n\nexport var LoginHeader = /*#__PURE__*/_styled('div', {\n  target: \"ecx9ydq0\"\n})(true ? {\n  name: \"1uaajjg\",\n  styles: \"display:grid;grid-gap:16px;grid-template-columns:auto min-content;align-items:end;\"\n} : {\n  name: \"1uaajjg\",\n  styles: \"display:grid;grid-gap:16px;grid-template-columns:auto min-content;align-items:end;\",\n  map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9heW9vbHV3YWFsZm9uc28vY29kZS9rcmFrZW5lZHVhcHAvcGFnZXMvbG9naW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBNEl5QyIsImZpbGUiOiIvVXNlcnMvYXlvb2x1d2FhbGZvbnNvL2NvZGUva3Jha2VuZWR1YXBwL3BhZ2VzL2xvZ2luLnRzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGggZnJvbSAncmVhY3QtaHlwZXJzY3JpcHQnXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluaydcblxuaW1wb3J0IHsgQm94LCBMYWJlbEJveCwgRm9ybUJveCB9IGZyb20gJ2NvbXBvbmVudHMvTGF5b3V0J1xuaW1wb3J0IHsgSW5wdXQsIEVycm9yLCBJbmZvIH0gZnJvbSAnY29tcG9uZW50cy9Gb3JtJ1xuaW1wb3J0IHsgUHJpbWFyeSB9IGZyb20gJ2NvbXBvbmVudHMvQnV0dG9uJ1xuaW1wb3J0IHtBY2NlbnRJbWcsIEhhbGZMb29wSW1nfSBmcm9tICdjb21wb25lbnRzL0ltYWdlcydcbmltcG9ydCB7IHVzZUFwaSB9IGZyb20gJ3NyYy9hcGlIZWxwZXJzJ1xuaW1wb3J0IHsgUmVzdWx0LCBNc2cgfSBmcm9tICdwYWdlcy9hcGkvbG9naW4nXG5pbXBvcnQgeyBSZXF1ZXN0TXNnLCBSZXF1ZXN0UmVzdWx0IH0gZnJvbSAncGFnZXMvYXBpL3VzZXIvcmVzZXRQYXNzd29yZC9bYWN0aW9uXSdcbmltcG9ydCB7IHVzZVVzZXJEYXRhIH0gZnJvbSAnc3JjL2RhdGEnXG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCdcblxuY29uc3QgQ09QWSA9IHtcbiAgZW1haWxPclVzZXJuYW1lSW5wdXQ6IFwiRW1haWwgb3IgVXNlcm5hbWVcIixcbiAgcGFzc3dvcmRJbnB1dDogXCJQYXNzd29yZFwiLFxuICByZXNldFBhc3N3b3JkOiBcIlJlc2V0IHBhc3N3b3JkXCIsXG4gIGxvZ2luSGVhZGVyOiBcIkxvZyBJblwiLFxuICB3cm9uZ0xvZ2luOiBoKCdkaXYnLCBbXG4gICAgXCJUaGUgZW1haWwvdXNlcm5hbWUgYW5kIHBhc3N3b3JkIGRvbid0IG1hdGNoXCIsIGgoJ2JyJyksIFwiSWYgeW91IHdhbnQsIHlvdSBjYW4gXCIsXG4gICAgaChMaW5rLCB7IGhyZWY6ICcvbG9naW4/cmVzZXQnIH0sIGgoJ2EnLCAncmVzZXQgeW91ciBwYXNzd29yZCBoZXJlJykpLFxuICAgICcuJ1xuICBdKSxcbiAgbG9naW5CdXR0b246IFwiTG9nIEluXCJcbn1cblxuY29uc3QgTG9naW4gPSAoKSA9PiB7XG4gIGxldCByb3V0ZXIgPSB1c2VSb3V0ZXIoKVxuICBsZXQgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSB1c2VTdGF0ZSh7IGVtYWlsT3JVc2VybmFtZTogJycsIHBhc3N3b3JkOiAnJyB9KVxuICBsZXQgcmVkaXJlY3QgPSByb3V0ZXIucXVlcnkucmVkaXJlY3QgYXMgc3RyaW5nIHwgbnVsbFxuICBsZXQgeyByZXNldCB9ID0gcm91dGVyLnF1ZXJ5XG4gIGxldCB7IGRhdGEsIG11dGF0ZSB9ID0gdXNlVXNlckRhdGEoKVxuICBsZXQgW3N0YXR1cywgY2FsbExvZ2luXSA9IHVzZUFwaTxNc2csIFJlc3VsdD4oW2Zvcm1EYXRhXSwgYXN5bmMgKHJlc3VsdCk9PiB7XG4gICAgaWYgKHJlZGlyZWN0KSB7XG4gICAgICBpZiAocmVkaXJlY3RbMF0gIT09ICcvJyB8fCByZWRpcmVjdC5zdGFydHNXaXRoKCcvc3NvJykpIHJldHVybiB3aW5kb3cubG9jYXRpb24uYXNzaWduKHJlZGlyZWN0KVxuICAgICAgYXdhaXQgbXV0YXRlKHJlc3VsdClcbiAgICAgIGF3YWl0IHJvdXRlci5wdXNoKHJlZGlyZWN0IGFzIHN0cmluZylcbiAgICB9XG4gICAgZWxzZSBhd2FpdCByb3V0ZXIucHVzaCgnL2Rhc2hib2FyZCcpXG4gIH0pXG5cbiAgY29uc3Qgb25TdWJtaXQgPSBhc3luYyAoZTogUmVhY3QuRm9ybUV2ZW50KSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY2FsbExvZ2luKCcvYXBpL2xvZ2luJywgZm9ybURhdGEpXG4gIH1cblxuICB1c2VFZmZlY3QoKCk9PiB7aWYgKGRhdGEpIHJvdXRlci5wdXNoKHJlZGlyZWN0IGFzIHN0cmluZyB8fCAnL2Rhc2hib2FyZCcpfSxbZGF0YV0pXG4gIGlmICh0eXBlb2YgcmVzZXQgIT09ICd1bmRlZmluZWQnKSByZXR1cm4gaChSZXNldFBhc3N3b3JkKVxuXG4gIHJldHVybiBoKEZvcm1Cb3gsIHtvblN1Ym1pdCwgd2lkdGg6IDQwMCwgbWE6IHRydWUsIGdhcDogMzJ9LCBbXG4gICAgaChCb3gsIFtcbiAgICAgIGgoTG9naW5IZWFkZXIsIFtcbiAgICAgICAgaCgnaDEnLCBDT1BZLmxvZ2luSGVhZGVyKSxcblxuICAgICAgICBoKEhhbGZMb29wSW1nLCB7XG4gICAgICAgICAgc3JjMTogJy9pbWcvZG9vci0xLmdpZicsXG4gICAgICAgICAgc3JjMjogJy9pbWcvZG9vci0yLmdpZicsXG4gICAgICAgICAgYWx0OiBcImFuIGFuaW1hdGVkIGdpZiBvZiBhIGVudHJhbmNlIHRvIHRoZSBzcGFya2xlIHZvaWRcIixcbiAgICAgICAgICBzdGFydExvb3A6IDEyMDAsXG4gICAgICAgIH0pLFxuICAgICAgXSksXG4gICAgICBoKCdwLnRleHRTZWNvbmRhcnknLCBbJ09yICcsIGgoTGluaywgeyBocmVmOiAnL3NpZ251cCcgfSwgaCgnYScsICdzaWduIHVwJykpLCAnIGZvciBhIG5ldyBhY2NvdW50J10pXG4gICAgXSksXG5cbiAgICBzdGF0dXMgPT09ICdlcnJvcicgPyBoKEVycm9yLCB7fSwgQ09QWS53cm9uZ0xvZ2luKSA6IG51bGwsXG5cbiAgICBoKExhYmVsQm94LCB7Z2FwOjh9LCBbXG4gICAgICBoKCdoNCcsIENPUFkuZW1haWxPclVzZXJuYW1lSW5wdXQpLFxuICAgICAgaChJbnB1dCwge1xuICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgIHZhbHVlOiBmb3JtRGF0YS5lbWFpbE9yVXNlcm5hbWUsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICBvbkNoYW5nZTogKGUpID0+IHNldEZvcm1EYXRhKHsgLi4uZm9ybURhdGEsIGVtYWlsT3JVc2VybmFtZTogZS5jdXJyZW50VGFyZ2V0LnZhbHVlIH0pXG4gICAgICB9KSxcbiAgICBdKSxcblxuICAgIGgoTGFiZWxCb3gsIHtnYXA6OH0sIFtcbiAgICAgIGgoJ2g0JywgQ09QWS5wYXNzd29yZElucHV0KSxcbiAgICAgIGgoSW5wdXQsIHtcbiAgICAgICAgdHlwZTogJ3Bhc3N3b3JkJyxcbiAgICAgICAgdmFsdWU6IGZvcm1EYXRhLnBhc3N3b3JkLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgb25DaGFuZ2U6IChlKSA9PiBzZXRGb3JtRGF0YSh7IC4uLmZvcm1EYXRhLCBwYXNzd29yZDogZS5jdXJyZW50VGFyZ2V0LnZhbHVlIH0pXG4gICAgICB9KSxcbiAgICAgIGgoTGluaywgeyBocmVmOiAnL2xvZ2luP3Jlc2V0J30sIGgoJ2EnLCB7c3R5bGU6e2p1c3RpZnlTZWxmOlwicmlnaHRcIn19LCBDT1BZLnJlc2V0UGFzc3dvcmQpKVxuICAgIF0pLFxuICAgIGgoUHJpbWFyeSwgeyB0eXBlOiAnc3VibWl0JyxzdGF0dXMsIHN0eWxlOntqdXN0aWZ5U2VsZjogXCJyaWdodFwifX0sIENPUFkubG9naW5CdXR0b24pLFxuICBdKVxufVxuXG5jb25zdCBSRVNFVENPUFkgPSB7XG4gIGhlYWRlcjogXCJSZXNldCBQYXNzd29yZFwiLFxuICBlbWFpbElucHV0OiBcIllvdXIgYWNjb3VudCBlbWFpbFwiLFxuICBidXR0b246IFwiUmVzZXQgUGFzc3dvcmRcIixcbiAgc3VjY2Vzc0hlYWRlcjogXCJDaGVjayB5b3VyIEVtYWlsXCJcbn1cblxuY29uc3QgUmVzZXRQYXNzd29yZCA9ICgpID0+IHtcbiAgbGV0IFtlbWFpbCwgc2V0RW1haWxdID0gdXNlU3RhdGUoJycpXG4gIGxldCBbc3RhdHVzLCBjYWxsUmVzZXRQYXNzd29yZCwgc2V0U3RhdHVzXSA9IHVzZUFwaTxSZXF1ZXN0TXNnLCBSZXF1ZXN0UmVzdWx0PihbZW1haWxdKVxuICBjb25zdCBvblN1Ym1pdCA9IGFzeW5jIChlOlJlYWN0LkZvcm1FdmVudCkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIGF3YWl0IGNhbGxSZXNldFBhc3N3b3JkKCcvYXBpL3VzZXIvcmVzZXRQYXNzd29yZC9yZXF1ZXN0JywgeyBlbWFpbCB9KVxuICB9XG5cbiAgc3dpdGNoIChzdGF0dXMpIHtcbiAgICBjYXNlICdub3JtYWwnOlxuICAgIGNhc2UgJ2xvYWRpbmcnOlxuICAgICAgcmV0dXJuIGgoRm9ybUJveCwge29uU3VibWl0LCB3aWR0aDogNDAwLCBtYTp0cnVlfSwgW1xuICAgICAgICBoKCdoMScsIFJFU0VUQ09QWS5oZWFkZXIpLFxuICAgICAgICBoKExhYmVsQm94LCB7Z2FwOjE2fSwgW1xuICAgICAgICAgIGgoJ2g0JywgUkVTRVRDT1BZLmVtYWlsSW5wdXQpLFxuICAgICAgICAgIGgoSW5wdXQsIHtcbiAgICAgICAgICAgIHR5cGU6ICdlbWFpbCcsXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBlbWFpbCxcbiAgICAgICAgICAgIG9uQ2hhbmdlOiBlID0+IHNldEVtYWlsKGUuY3VycmVudFRhcmdldC52YWx1ZSlcbiAgICAgICAgICB9KSxcbiAgICAgICAgXSksXG4gICAgICAgIGgoJ2RpdicsIHsgc3R5bGU6IHsgZGlzcGxheTogJ2dyaWQnLCBqdXN0aWZ5SXRlbXM6ICdlbmQnLCBncmlkR2FwOiAnOHB4JyB9IH0sIFtcbiAgICAgICAgICBoKFByaW1hcnksIHsgdHlwZTogJ3N1Ym1pdCcsIHN0YXR1c30sIFJFU0VUQ09QWS5idXR0b24pXG4gICAgICAgIF0pXG4gICAgICBdKVxuICAgIGNhc2UgJ3N1Y2Nlc3MnOiByZXR1cm4gaChCb3gsIHsgZ2FwOiAxNiwgd2lkdGg6IDQwMCwgbWE6IHRydWUgfSwgW1xuICAgICAgaChBY2NlbnRJbWcsIHtzcmM6ICcvaW1nL3BsYW5lLmdpZicsIGFsdDogXCJhbiBhbmltYXRlZCBnaWYgb2YgYSBwYXBlciBhaXJwbGFuZSB0YWtpbmcgb2ZmXCJ9KSxcbiAgICAgIGgoJ2gxJywgUkVTRVRDT1BZLnN1Y2Nlc3NIZWFkZXIpLFxuICAgICAgJ1dlIHNlbnQgYW4gZW1haWwgd2l0aCBhIHBhc3N3b3JkIHJlc2V0IGxpbmsgdG8nLFxuICAgICAgaChJbmZvLCBlbWFpbCksXG4gICAgICAnSXQgZXhwaXJlcyBpbiAzMCBtaW51dGVzLicsXG4gICAgICBoKCdicicpLFxuICAgICAgaChQcmltYXJ5LCB7XG4gICAgICAgIHN0eWxlOiB7IHdpZHRoOiAnMTAwJScgfSxcbiAgICAgICAgb25DbGljazogKCkgPT4gc2V0U3RhdHVzKCdub3JtYWwnKVxuICAgICAgfSwgJ1NlbmQgYW5vdGhlciBsaW5rJylcbiAgICBdKVxuICAgIGNhc2UgJ2Vycm9yJzogcmV0dXJuIGgoQm94LCB7d2lkdGg6IDQwMCwgbWE6IHRydWV9LCBbaChFcnJvciwgJ3NvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgcmVmcmVzaCBhbmQgdHJ5IGFnYWluJyldKVxuICB9XG59XG5leHBvcnQgY29uc3QgTG9naW5IZWFkZXIgPSBzdHlsZWQoJ2RpdicpIGBcbiAgZGlzcGxheTpncmlkO1xuICBncmlkLWdhcDoxNnB4O1xuICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IGF1dG8gbWluLWNvbnRlbnQ7XG4gIGFsaWduLWl0ZW1zOiBlbmQ7XG5gXG5leHBvcnQgZGVmYXVsdCBMb2dpblxuIl19 */\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n});\nexport default Login;","map":{"version":3,"sources":["/Users/ayooluwaalfonso/code/krakeneduapp/pages/login.ts"],"names":["h","useState","useEffect","useRouter","Link","Box","LabelBox","FormBox","Input","Error","Info","Primary","AccentImg","HalfLoopImg","useApi","useUserData","COPY","emailOrUsernameInput","passwordInput","resetPassword","loginHeader","wrongLogin","href","loginButton","Login","router","emailOrUsername","password","formData","setFormData","redirect","query","reset","data","mutate","result","startsWith","window","location","assign","push","status","callLogin","onSubmit","e","preventDefault","ResetPassword","width","ma","gap","LoginHeader","src1","src2","alt","startLoop","type","value","required","onChange","currentTarget","style","justifySelf","RESETCOPY","header","emailInput","button","successHeader","email","setEmail","callResetPassword","setStatus","display","justifyItems","gridGap","src","onClick"],"mappings":"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","sourcesContent":["import h from 'react-hyperscript'\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/router'\nimport Link from 'next/link'\n\nimport { Box, LabelBox, FormBox } from 'components/Layout'\nimport { Input, Error, Info } from 'components/Form'\nimport { Primary } from 'components/Button'\nimport {AccentImg, HalfLoopImg} from 'components/Images'\nimport { useApi } from 'src/apiHelpers'\nimport { Result, Msg } from 'pages/api/login'\nimport { RequestMsg, RequestResult } from 'pages/api/user/resetPassword/[action]'\nimport { useUserData } from 'src/data'\nimport styled from '@emotion/styled'\n\nconst COPY = {\n  emailOrUsernameInput: \"Email or Username\",\n  passwordInput: \"Password\",\n  resetPassword: \"Reset password\",\n  loginHeader: \"Log In\",\n  wrongLogin: h('div', [\n    \"The email/username and password don't match\", h('br'), \"If you want, you can \",\n    h(Link, { href: '/login?reset' }, h('a', 'reset your password here')),\n    '.'\n  ]),\n  loginButton: \"Log In\"\n}\n\nconst Login = () => {\n  let router = useRouter()\n  let [formData, setFormData] = useState({ emailOrUsername: '', password: '' })\n  let redirect = router.query.redirect as string | null\n  let { reset } = router.query\n  let { data, mutate } = useUserData()\n  let [status, callLogin] = useApi<Msg, Result>([formData], async (result)=> {\n    if (redirect) {\n      if (redirect[0] !== '/' || redirect.startsWith('/sso')) return window.location.assign(redirect)\n      await mutate(result)\n      await router.push(redirect as string)\n    }\n    else await router.push('/dashboard')\n  })\n\n  const onSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    callLogin('/api/login', formData)\n  }\n\n  useEffect(()=> {if (data) router.push(redirect as string || '/dashboard')},[data])\n  if (typeof reset !== 'undefined') return h(ResetPassword)\n\n  return h(FormBox, {onSubmit, width: 400, ma: true, gap: 32}, [\n    h(Box, [\n      h(LoginHeader, [\n        h('h1', COPY.loginHeader),\n\n        h(HalfLoopImg, {\n          src1: '/img/door-1.gif',\n          src2: '/img/door-2.gif',\n          alt: \"an animated gif of a entrance to the sparkle void\",\n          startLoop: 1200,\n        }),\n      ]),\n      h('p.textSecondary', ['Or ', h(Link, { href: '/signup' }, h('a', 'sign up')), ' for a new account'])\n    ]),\n\n    status === 'error' ? h(Error, {}, COPY.wrongLogin) : null,\n\n    h(LabelBox, {gap:8}, [\n      h('h4', COPY.emailOrUsernameInput),\n      h(Input, {\n        type: 'text',\n        value: formData.emailOrUsername,\n        required: true,\n        onChange: (e) => setFormData({ ...formData, emailOrUsername: e.currentTarget.value })\n      }),\n    ]),\n\n    h(LabelBox, {gap:8}, [\n      h('h4', COPY.passwordInput),\n      h(Input, {\n        type: 'password',\n        value: formData.password,\n        required: true,\n        onChange: (e) => setFormData({ ...formData, password: e.currentTarget.value })\n      }),\n      h(Link, { href: '/login?reset'}, h('a', {style:{justifySelf:\"right\"}}, COPY.resetPassword))\n    ]),\n    h(Primary, { type: 'submit',status, style:{justifySelf: \"right\"}}, COPY.loginButton),\n  ])\n}\n\nconst RESETCOPY = {\n  header: \"Reset Password\",\n  emailInput: \"Your account email\",\n  button: \"Reset Password\",\n  successHeader: \"Check your Email\"\n}\n\nconst ResetPassword = () => {\n  let [email, setEmail] = useState('')\n  let [status, callResetPassword, setStatus] = useApi<RequestMsg, RequestResult>([email])\n  const onSubmit = async (e:React.FormEvent) => {\n    e.preventDefault()\n    await callResetPassword('/api/user/resetPassword/request', { email })\n  }\n\n  switch (status) {\n    case 'normal':\n    case 'loading':\n      return h(FormBox, {onSubmit, width: 400, ma:true}, [\n        h('h1', RESETCOPY.header),\n        h(LabelBox, {gap:16}, [\n          h('h4', RESETCOPY.emailInput),\n          h(Input, {\n            type: 'email',\n            required: true,\n            value: email,\n            onChange: e => setEmail(e.currentTarget.value)\n          }),\n        ]),\n        h('div', { style: { display: 'grid', justifyItems: 'end', gridGap: '8px' } }, [\n          h(Primary, { type: 'submit', status}, RESETCOPY.button)\n        ])\n      ])\n    case 'success': return h(Box, { gap: 16, width: 400, ma: true }, [\n      h(AccentImg, {src: '/img/plane.gif', alt: \"an animated gif of a paper airplane taking off\"}),\n      h('h1', RESETCOPY.successHeader),\n      'We sent an email with a password reset link to',\n      h(Info, email),\n      'It expires in 30 minutes.',\n      h('br'),\n      h(Primary, {\n        style: { width: '100%' },\n        onClick: () => setStatus('normal')\n      }, 'Send another link')\n    ])\n    case 'error': return h(Box, {width: 400, ma: true}, [h(Error, 'something went wrong, please refresh and try again')])\n  }\n}\nexport const LoginHeader = styled('div') `\n  display:grid;\n  grid-gap:16px;\n  grid-template-columns: auto min-content;\n  align-items: end;\n`\nexport default Login\n"]},"metadata":{},"sourceType":"module"}