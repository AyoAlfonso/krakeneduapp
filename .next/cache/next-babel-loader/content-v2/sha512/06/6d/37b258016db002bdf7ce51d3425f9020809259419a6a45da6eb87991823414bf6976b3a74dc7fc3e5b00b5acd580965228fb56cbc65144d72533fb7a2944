{"ast":null,"code":"import _styled from \"@emotion/styled-base\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nimport h from 'react-hyperscript';\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport Link from 'next/link';\nimport { Box, LabelBox, FormBox } from 'components/Layout';\nimport { Input, Error, Info, CheckBox, PasswordInput } from 'components/Form';\nimport { Primary } from 'components/Button';\nimport { AccentImg, HalfLoopImg } from 'components/Images';\nimport { useUserData } from 'src/data';\nimport { callApi, useApi } from 'src/apiHelpers';\nimport { useDebouncedEffect } from 'src/hooks';\nimport { usernameValidate } from 'src/utils';\nconst COPY = {\n  submitButton: \"Create your account\",\n  headerDescription: \"We're hyped for you to join the KrakenEdu community! Let's learn together.\"\n};\n\nconst Signup = () => {\n  let {\n    0: formData,\n    1: setFormData\n  } = useState({\n    email: '',\n    username: '',\n    password: '',\n    newsletter: false\n  });\n  let [status, callSignupRequest] = useApi([formData], () => router.push('/signup?verifyEmail'));\n  let {\n    0: usernameValid,\n    1: setUsernameValid\n  } = useState(null);\n  let {\n    data: user\n  } = useUserData();\n  let router = useRouter();\n  useEffect(() => {\n    if (user) router.push('/dashboard');\n  }, [user]);\n  useDebouncedEffect(async () => {\n    if (!formData.username) return setUsernameValid(null);\n    if (!usernameValidate(formData.username)) return setUsernameValid(null);\n    let res = await callApi('/api/get/username/' + formData.username);\n    if (res.status === 404) setUsernameValid(true);else setUsernameValid(false);\n  }, 500, [formData.username]);\n\n  const onSubmit = async e => {\n    e.preventDefault();\n    await callSignupRequest('/api/signup/request', formData);\n  };\n\n  if (router.query.verifyEmail !== undefined) {\n    return h(VerifyEmail, {\n      email: formData.email,\n      resendEmail: onSubmit\n    });\n  }\n\n  return h(FormBox, {\n    onSubmit,\n    width: 400,\n    ma: true,\n    gap: 32\n  }, [h(Box, {\n    gap: 8\n  }, [h(SignUpHeader, [h('h1', 'Sign Up'), h(HalfLoopImg, {\n    src1: '/img/sailboat-1.gif',\n    src2: '/img/sailboat-2.gif',\n    alt: \"an animated gif of a sailboat, boatin'\",\n    startLoop: 333\n  })]), h('p.big', COPY.headerDescription), h('p.textSecondary', ['Or ', h(Link, {\n    href: \"/login\"\n  }, h('a', 'log in')), ' with an existing account.'])]), status === 'error' ? h(Error, {}, h('div', [\"A user already exists with that email. Try \", h(Link, {\n    href: '/login'\n  }, h('a', 'logging in')), '.'])) : null, h(LabelBox, {\n    gap: 8\n  }, [h('div', [h('h4', \"Username\"), h('small.textSecondary', \"Pick a unique username between 3-15 characters.\")]), h(Input, {\n    type: 'text',\n    name: \"username\",\n    required: true,\n    minLength: 3,\n    maxLength: 15,\n    value: formData.username,\n    onChange: e => {\n      setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n        username: e.currentTarget.value\n      }));\n\n      if (!usernameValidate(e.currentTarget.value || '')) {\n        e.currentTarget.setCustomValidity('Your username must contain only letters, numbers, underscores, periods or dashes');\n      } else {\n        e.currentTarget.setCustomValidity('');\n      }\n    }\n  }), formData.username.length < 3 ? null : !usernameValidate(formData.username) ? h('span.accentRed', 'Your username must contain only letters, numbers, underscores, periods or dashes') : usernameValid === null ? '' : usernameValid ? h('span.accentSuccess', 'Great! This username is available.') : h('span.accentRed', \"Sorry, that username is taken.\")]), h(LabelBox, {\n    gap: 8\n  }, [h('div', [h('h4', \"Your Email\"), h('small.textSecondary', \"You'll have to verify this in a moment.\")]), h(Input, {\n    type: 'email',\n    name: 'email',\n    required: true,\n    value: formData.email,\n    onChange: e => setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n      email: e.currentTarget.value\n    }))\n  })]), h(LabelBox, {\n    gap: 8\n  }, [h(\"div\", [h('h4', \"Password\"), h('small.textSecondary', \"Minimum length 8 characters\")]), h(PasswordInput, {\n    name: \"new-password\",\n    required: true,\n    minLength: 8,\n    value: formData.password,\n    onChange: e => setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n      password: e.currentTarget.value\n    }))\n  })]), h(LabelBox, {\n    gap: 8\n  }, [h('div', [h('h4', \"Get email updates?\"), h('small.textSecondary', \"We send out occasional updates on new courses and features. We'll never spam or share your email.\")]), h(CheckBox, [h(Input, {\n    type: 'checkbox',\n    name: 'newsletter',\n    checked: formData.newsletter,\n    onChange: e => {\n      setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n        newsletter: e.currentTarget.checked\n      }));\n    }\n  }), \"Sure! Gimme the updates.\"])]), h(Primary, {\n    status,\n    style: {\n      justifySelf: 'end'\n    },\n    type: 'submit'\n  }, COPY.submitButton)]);\n};\n\nconst VerifyEmail = props => {\n  let router = useRouter();\n  let {\n    0: key,\n    1: setKey\n  } = useState('');\n  let [status, callSignupVerify] = useApi([key], () => {\n    setTimeout(() => {\n      router.push('/dashboard');\n    }, 3000);\n  });\n\n  const onSubmit = async e => {\n    e.preventDefault();\n    await callSignupVerify('/api/signup/verify', {\n      key\n    });\n  };\n\n  useEffect(() => {\n    if (router.query.verifyEmail && typeof router.query.verifyEmail === 'string') {\n      callSignupVerify('/api/signup/verify', {\n        key: router.query.verifyEmail\n      });\n    }\n  }, []);\n  if (router.query.verifyEmail && status === null) return null;\n  if (status === 'success') return h(Box, {\n    width: 400,\n    ma: true,\n    gap: 16\n  }, [h(\"h1\", \"All Done!\"), h(\"p.big\", \"Click the button below if you're not redirected in a couple seconds\"), h(Link, {\n    href: \"/dashboard\"\n  }, h(\"a\", {}, h(Primary, \"Back to Krakenedu\")))]);\n  return h(FormBox, {\n    onSubmit,\n    width: 400,\n    ma: true,\n    gap: 32\n  }, [h(AccentImg, {\n    src: '/img/plane.gif',\n    alt: \"an animated gif of a paper airplane taking off\"\n  }), h('h1', 'Verify your email'), props.email ? h(Box, {\n    gap: 8\n  }, [`Sweet! We sent an email with a verification code to`, h(Info, {}, h('b', props.email))]) : null, h(Box, {\n    gap: 8\n  }, [h('h4', `Copy the code there and submit it here:`), h(Input, {\n    spellCheck: false,\n    type: 'text',\n    value: key,\n    onChange: e => setKey(e.currentTarget.value.trim())\n  })]), status === 'error' ? h(Error, {}, ['Your email link is invalid or out of date, please try ', h(Link, {\n    href: '/signup'\n  }, h('a', 'signing up again')), '.']) : null, h(Primary, {\n    type: 'submit',\n    status,\n    style: {\n      justifySelf: 'right'\n    }\n  }, \"Confirm your email\")]);\n};\n\nexport const SignUpHeader = /*#__PURE__*/_styled('div', {\n  target: \"e1qhha6s0\"\n})(true ? {\n  name: \"1uaajjg\",\n  styles: \"display:grid;grid-gap:16px;grid-template-columns:auto min-content;align-items:end;\"\n} : {\n  name: \"1uaajjg\",\n  styles: \"display:grid;grid-gap:16px;grid-template-columns:auto min-content;align-items:end;\",\n  map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9heW9vbHV3YWFsZm9uc28vY29kZS9rcmFrZW5lZHVhcHAvcGFnZXMvc2lnbnVwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXFNMEMiLCJmaWxlIjoiL1VzZXJzL2F5b29sdXdhYWxmb25zby9jb2RlL2tyYWtlbmVkdWFwcC9wYWdlcy9zaWdudXAudHMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaCBmcm9tICdyZWFjdC1oeXBlcnNjcmlwdCdcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7dXNlUm91dGVyfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluaydcblxuaW1wb3J0IHsgQm94LCBMYWJlbEJveCwgRm9ybUJveH0gZnJvbSAnY29tcG9uZW50cy9MYXlvdXQnXG5pbXBvcnQgeyBJbnB1dCwgRXJyb3IsIEluZm8sIENoZWNrQm94LCBQYXNzd29yZElucHV0fSBmcm9tICdjb21wb25lbnRzL0Zvcm0nXG5pbXBvcnQgeyBQcmltYXJ5IH0gZnJvbSAnY29tcG9uZW50cy9CdXR0b24nXG5pbXBvcnQge0FjY2VudEltZywgSGFsZkxvb3BJbWd9IGZyb20gJ2NvbXBvbmVudHMvSW1hZ2VzJ1xuaW1wb3J0IHsgdXNlVXNlckRhdGEgfSBmcm9tICdzcmMvZGF0YSdcbmltcG9ydCB7IGNhbGxBcGksIHVzZUFwaSB9IGZyb20gJ3NyYy9hcGlIZWxwZXJzJ1xuaW1wb3J0IHsgdXNlRGVib3VuY2VkRWZmZWN0fSBmcm9tICdzcmMvaG9va3MnXG5pbXBvcnQgeyBWZXJpZnlFbWFpbE1zZywgU2lnbnVwTXNnLCBWZXJpZnlFbWFpbFJlc3BvbnNlLCBTaWdudXBSZXNwb25zZX0gZnJvbSAncGFnZXMvYXBpL3NpZ251cC9bYWN0aW9uXSdcbmltcG9ydCB7IENoZWNrVXNlcm5hbWVSZXN1bHQgfSBmcm9tICdwYWdlcy9hcGkvZ2V0L1suLi5pdGVtXSdcbmltcG9ydCBzdHlsZWQgZnJvbSAnQGVtb3Rpb24vc3R5bGVkJ1xuaW1wb3J0IHsgdXNlcm5hbWVWYWxpZGF0ZSB9IGZyb20gJ3NyYy91dGlscydcblxuY29uc3QgQ09QWSA9IHtcbiAgc3VibWl0QnV0dG9uOiBcIkNyZWF0ZSB5b3VyIGFjY291bnRcIixcbiAgaGVhZGVyRGVzY3JpcHRpb246XG4gICAgXCJXZSdyZSBoeXBlZCBmb3IgeW91IHRvIGpvaW4gdGhlIEtyYWtlbkVkdSBjb21tdW5pdHkhIExldCdzIGxlYXJuIHRvZ2V0aGVyLlwiLFxufTtcblxuY29uc3QgU2lnbnVwID0gKCkgPT4ge1xuICBsZXQgW2Zvcm1EYXRhLCBzZXRGb3JtRGF0YV0gPSB1c2VTdGF0ZSh7XG4gICAgZW1haWw6JycsXG4gICAgdXNlcm5hbWU6ICcnLFxuICAgIHBhc3N3b3JkOicnLFxuICAgIG5ld3NsZXR0ZXI6IGZhbHNlLFxuICB9KVxuXG4gIGxldCBbc3RhdHVzLCBjYWxsU2lnbnVwUmVxdWVzdF0gPSB1c2VBcGk8U2lnbnVwTXNnLCBTaWdudXBSZXNwb25zZT4oW2Zvcm1EYXRhXSwgKCk9PiByb3V0ZXIucHVzaCgnL3NpZ251cD92ZXJpZnlFbWFpbCcpKVxuICBsZXQgW3VzZXJuYW1lVmFsaWQsIHNldFVzZXJuYW1lVmFsaWRdID0gdXNlU3RhdGU8bnVsbCB8IGJvb2xlYW4+KG51bGwpXG4gIGxldCB7ZGF0YTp1c2VyfSA9IHVzZVVzZXJEYXRhKClcbiAgbGV0IHJvdXRlciA9IHVzZVJvdXRlcigpXG5cbiAgdXNlRWZmZWN0KCgpPT57aWYodXNlcikgcm91dGVyLnB1c2goJy9kYXNoYm9hcmQnKX0sIFt1c2VyXSlcbiAgdXNlRGVib3VuY2VkRWZmZWN0KGFzeW5jICgpPT57XG4gICAgaWYoIWZvcm1EYXRhLnVzZXJuYW1lKSByZXR1cm4gc2V0VXNlcm5hbWVWYWxpZChudWxsKVxuICAgIGlmKCF1c2VybmFtZVZhbGlkYXRlKGZvcm1EYXRhLnVzZXJuYW1lKSkgcmV0dXJuIHNldFVzZXJuYW1lVmFsaWQobnVsbClcbiAgICBsZXQgcmVzID0gYXdhaXQgY2FsbEFwaTxudWxsLCBDaGVja1VzZXJuYW1lUmVzdWx0PignL2FwaS9nZXQvdXNlcm5hbWUvJytmb3JtRGF0YS51c2VybmFtZSlcbiAgICBpZihyZXMuc3RhdHVzPT09NDA0KSBzZXRVc2VybmFtZVZhbGlkKHRydWUpXG4gICAgZWxzZSBzZXRVc2VybmFtZVZhbGlkKGZhbHNlKVxuICB9LCA1MDAsIFtmb3JtRGF0YS51c2VybmFtZV0pXG5cbiAgY29uc3Qgb25TdWJtaXQgPSBhc3luYyAoZTpSZWFjdC5Gb3JtRXZlbnQpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBhd2FpdCBjYWxsU2lnbnVwUmVxdWVzdCgnL2FwaS9zaWdudXAvcmVxdWVzdCcsIGZvcm1EYXRhKVxuICB9XG5cbiAgaWYocm91dGVyLnF1ZXJ5LnZlcmlmeUVtYWlsICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gaChWZXJpZnlFbWFpbCwge2VtYWlsOiBmb3JtRGF0YS5lbWFpbCwgcmVzZW5kRW1haWw6IG9uU3VibWl0fSlcbiAgfVxuXG4gIHJldHVybiBoKEZvcm1Cb3gsIHtvblN1Ym1pdCwgd2lkdGg6IDQwMCwgbWE6IHRydWUsIGdhcDogMzJ9LCBbXG4gICAgaChCb3gsIHtnYXA6OH0sIFtcbiAgICAgIGgoU2lnblVwSGVhZGVyLCBbXG4gICAgICAgIGgoJ2gxJywgJ1NpZ24gVXAnKSxcbiAgICAgICAgaChIYWxmTG9vcEltZywge1xuICAgICAgICAgIHNyYzE6ICcvaW1nL3NhaWxib2F0LTEuZ2lmJyxcbiAgICAgICAgICBzcmMyOiAnL2ltZy9zYWlsYm9hdC0yLmdpZicsXG4gICAgICAgICAgYWx0OiBcImFuIGFuaW1hdGVkIGdpZiBvZiBhIHNhaWxib2F0LCBib2F0aW4nXCIsXG4gICAgICAgICAgc3RhcnRMb29wOiAzMzMsXG4gICAgICAgIH0pLFxuICAgICAgXSksXG4gICAgICBoKCdwLmJpZycsIENPUFkuaGVhZGVyRGVzY3JpcHRpb24pLFxuICAgICAgaCgncC50ZXh0U2Vjb25kYXJ5JywgWydPciAnLCBoKExpbmssIHtocmVmOlwiL2xvZ2luXCJ9LCBoKCdhJywgJ2xvZyBpbicpKSwgJyB3aXRoIGFuIGV4aXN0aW5nIGFjY291bnQuJ10pXG4gICAgXSksXG4gICAgc3RhdHVzID09PSAnZXJyb3InID8gaChFcnJvciwge30sIGgoJ2RpdicsIFtcbiAgICAgIFwiQSB1c2VyIGFscmVhZHkgZXhpc3RzIHdpdGggdGhhdCBlbWFpbC4gVHJ5IFwiLCBoKExpbmsse2hyZWY6Jy9sb2dpbid9LCBoKCdhJywgJ2xvZ2dpbmcgaW4nKSksXG4gICAgICAnLidcbiAgICBdKSkgOiBudWxsLFxuICAgIGgoTGFiZWxCb3gsIHtnYXA6OH0sW1xuICAgICAgaCgnZGl2JywgW1xuICAgICAgICBoKCdoNCcsIFwiVXNlcm5hbWVcIiksXG4gICAgICAgIGgoJ3NtYWxsLnRleHRTZWNvbmRhcnknLCBcIlBpY2sgYSB1bmlxdWUgdXNlcm5hbWUgYmV0d2VlbiAzLTE1IGNoYXJhY3RlcnMuXCIpLFxuICAgICAgXSksXG4gICAgICBoKElucHV0LCB7XG4gICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgbmFtZTogXCJ1c2VybmFtZVwiLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgbWluTGVuZ3RoOiAzLFxuICAgICAgICBtYXhMZW5ndGg6IDE1LFxuICAgICAgICB2YWx1ZTogZm9ybURhdGEudXNlcm5hbWUsXG4gICAgICAgIG9uQ2hhbmdlOiAoZSk9PiB7XG4gICAgICAgICAgc2V0Rm9ybURhdGEoey4uLmZvcm1EYXRhLCB1c2VybmFtZTplLmN1cnJlbnRUYXJnZXQudmFsdWV9KVxuICAgICAgICAgIGlmKCF1c2VybmFtZVZhbGlkYXRlKGUuY3VycmVudFRhcmdldC52YWx1ZSB8fCAnJykpe1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnNldEN1c3RvbVZhbGlkaXR5KCdZb3VyIHVzZXJuYW1lIG11c3QgY29udGFpbiBvbmx5IGxldHRlcnMsIG51bWJlcnMsIHVuZGVyc2NvcmVzLCBwZXJpb2RzIG9yIGRhc2hlcycpXG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnNldEN1c3RvbVZhbGlkaXR5KCcnKVxuICAgICAgICAgIH1cbiAgICAgICAgfX0pLFxuICAgICAgZm9ybURhdGEudXNlcm5hbWUubGVuZ3RoIDwgMyA/IG51bGwgOlxuICAgICAgICAhdXNlcm5hbWVWYWxpZGF0ZShmb3JtRGF0YS51c2VybmFtZSkgPyBoKCdzcGFuLmFjY2VudFJlZCcsICdZb3VyIHVzZXJuYW1lIG11c3QgY29udGFpbiBvbmx5IGxldHRlcnMsIG51bWJlcnMsIHVuZGVyc2NvcmVzLCBwZXJpb2RzIG9yIGRhc2hlcycpIDpcbiAgICAgICAgdXNlcm5hbWVWYWxpZCA9PT0gbnVsbFxuICAgICAgICA/ICcnXG4gICAgICAgIDogdXNlcm5hbWVWYWxpZCA/IGgoJ3NwYW4uYWNjZW50U3VjY2VzcycsICdHcmVhdCEgVGhpcyB1c2VybmFtZSBpcyBhdmFpbGFibGUuJykgOiBoKCdzcGFuLmFjY2VudFJlZCcsIFwiU29ycnksIHRoYXQgdXNlcm5hbWUgaXMgdGFrZW4uXCIpXG4gICAgXSksXG4gICAgaChMYWJlbEJveCwge2dhcDo4fSwgW1xuICAgICAgaCgnZGl2JywgW1xuICAgICAgICBoKCdoNCcsIFwiWW91ciBFbWFpbFwiKSxcbiAgICAgICAgaCgnc21hbGwudGV4dFNlY29uZGFyeScsIFwiWW91J2xsIGhhdmUgdG8gdmVyaWZ5IHRoaXMgaW4gYSBtb21lbnQuXCIpLFxuICAgICAgXSksXG4gICAgICBoKElucHV0LCB7dHlwZTogJ2VtYWlsJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnZW1haWwnLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBmb3JtRGF0YS5lbWFpbCxcbiAgICAgICAgICAgICAgICBvbkNoYW5nZTogKGUpPT4gc2V0Rm9ybURhdGEoey4uLmZvcm1EYXRhLCBlbWFpbDplLmN1cnJlbnRUYXJnZXQudmFsdWV9KX0pXG4gICAgXSksXG4gICAgaChMYWJlbEJveCwge2dhcDo4fSwgW1xuICAgICAgaChcImRpdlwiLCBbXG4gICAgICAgIGgoJ2g0JywgXCJQYXNzd29yZFwiKSxcbiAgICAgICAgaCgnc21hbGwudGV4dFNlY29uZGFyeScsIFwiTWluaW11bSBsZW5ndGggOCBjaGFyYWN0ZXJzXCIpLFxuICAgICAgXSksXG4gICAgICBoKFBhc3N3b3JkSW5wdXQsIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcIm5ldy1wYXNzd29yZFwiLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIG1pbkxlbmd0aDogOCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZm9ybURhdGEucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgb25DaGFuZ2U6IChlKT0+IHNldEZvcm1EYXRhKHsuLi5mb3JtRGF0YSwgcGFzc3dvcmQ6ZS5jdXJyZW50VGFyZ2V0LnZhbHVlfSl9KVxuICAgIF0pLFxuICAgIGgoTGFiZWxCb3gsIHtnYXA6OH0sIFtcbiAgICAgIGgoJ2RpdicsIFtcbiAgICAgICAgaCgnaDQnLCBcIkdldCBlbWFpbCB1cGRhdGVzP1wiKSxcbiAgICAgICAgaCgnc21hbGwudGV4dFNlY29uZGFyeScsIFwiV2Ugc2VuZCBvdXQgb2NjYXNpb25hbCB1cGRhdGVzIG9uIG5ldyBjb3Vyc2VzIGFuZCBmZWF0dXJlcy4gV2UnbGwgbmV2ZXIgc3BhbSBvciBzaGFyZSB5b3VyIGVtYWlsLlwiKSxcbiAgICAgIF0pLFxuICAgICAgaChDaGVja0JveCwgW1xuICAgICAgICBoKElucHV0LCB7dHlwZTogJ2NoZWNrYm94JywgbmFtZTogJ25ld3NsZXR0ZXInLCBjaGVja2VkOiBmb3JtRGF0YS5uZXdzbGV0dGVyLCBvbkNoYW5nZTogZT0+IHtcbiAgICAgICAgICBzZXRGb3JtRGF0YSh7Li4uZm9ybURhdGEsIG5ld3NsZXR0ZXI6IGUuY3VycmVudFRhcmdldC5jaGVja2VkfSlcbiAgICAgICAgfX0pLFxuICAgICAgICBcIlN1cmUhIEdpbW1lIHRoZSB1cGRhdGVzLlwiXG4gICAgICBdKSxcbiAgICBdKSxcbiAgICBoKFByaW1hcnksIHtzdGF0dXMsIHN0eWxlOiB7anVzdGlmeVNlbGY6ICdlbmQnfSwgdHlwZTogJ3N1Ym1pdCd9LCBDT1BZLnN1Ym1pdEJ1dHRvbiksXG4gIF0pXG59XG5cbmNvbnN0IFZlcmlmeUVtYWlsID0gKHByb3BzOiB7ZW1haWw/OnN0cmluZywgcmVzZW5kRW1haWw6IGFueX0pID0+ICB7XG4gIGxldCByb3V0ZXIgPSB1c2VSb3V0ZXIoKVxuICBsZXQgW2tleSwgc2V0S2V5XSA9IHVzZVN0YXRlKCcnKVxuICBsZXQgW3N0YXR1cywgY2FsbFNpZ251cFZlcmlmeV0gPSB1c2VBcGk8VmVyaWZ5RW1haWxNc2csIFZlcmlmeUVtYWlsUmVzcG9uc2U+KFtrZXldLCAoKT0+e1xuICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgIHJvdXRlci5wdXNoKCcvZGFzaGJvYXJkJylcbiAgICB9LCAzMDAwKVxuICB9KVxuXG4gIGNvbnN0IG9uU3VibWl0ID0gYXN5bmMgKGU6IFJlYWN0LkZvcm1FdmVudCk9PntcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICBhd2FpdCBjYWxsU2lnbnVwVmVyaWZ5KCcvYXBpL3NpZ251cC92ZXJpZnknLCB7a2V5fSlcbiAgfVxuXG4gIHVzZUVmZmVjdCgoKT0+e1xuICAgIGlmKHJvdXRlci5xdWVyeS52ZXJpZnlFbWFpbCAmJiB0eXBlb2Ygcm91dGVyLnF1ZXJ5LnZlcmlmeUVtYWlsID09PSAnc3RyaW5nJykge1xuICAgICAgY2FsbFNpZ251cFZlcmlmeSgnL2FwaS9zaWdudXAvdmVyaWZ5Jywge2tleTpyb3V0ZXIucXVlcnkudmVyaWZ5RW1haWx9KVxuICAgIH1cbiAgfSwgW10pXG5cbiAgaWYocm91dGVyLnF1ZXJ5LnZlcmlmeUVtYWlsICYmIHN0YXR1cyA9PT0gbnVsbCkgcmV0dXJuIG51bGxcblxuICBpZihzdGF0dXMgPT09ICdzdWNjZXNzJykgcmV0dXJuIGgoQm94LCB7IHdpZHRoOiA0MDAsIG1hOiB0cnVlLCBnYXA6IDE2IH0sIFtcbiAgICBoKFwiaDFcIiwgXCJBbGwgRG9uZSFcIiksXG4gICAgaChcbiAgICAgIFwicC5iaWdcIixcbiAgICAgIFwiQ2xpY2sgdGhlIGJ1dHRvbiBiZWxvdyBpZiB5b3UncmUgbm90IHJlZGlyZWN0ZWQgaW4gYSBjb3VwbGUgc2Vjb25kc1wiXG4gICAgKSxcbiAgICBoKFxuICAgICAgTGluayxcbiAgICAgIHsgaHJlZjogXCIvZGFzaGJvYXJkXCIgfSxcbiAgICAgIGgoXCJhXCIsIHt9LCBoKFByaW1hcnksIFwiQmFjayB0byBLcmFrZW5lZHVcIikpXG4gICAgKSxcbiAgXSk7XG5cbiAgcmV0dXJuIGgoRm9ybUJveCwge29uU3VibWl0LCB3aWR0aDogNDAwLCBtYTogdHJ1ZSwgZ2FwOiAzMn0sIFtcbiAgICBoKEFjY2VudEltZywge3NyYzogJy9pbWcvcGxhbmUuZ2lmJywgYWx0OiBcImFuIGFuaW1hdGVkIGdpZiBvZiBhIHBhcGVyIGFpcnBsYW5lIHRha2luZyBvZmZcIiB9KSxcbiAgICBoKCdoMScsICdWZXJpZnkgeW91ciBlbWFpbCcpLFxuICAgIHByb3BzLmVtYWlsID8gaChCb3gsIHtnYXA6IDh9LCBbXG4gICAgICBgU3dlZXQhIFdlIHNlbnQgYW4gZW1haWwgd2l0aCBhIHZlcmlmaWNhdGlvbiBjb2RlIHRvYCxcbiAgICAgIGgoSW5mbywge30sIGgoJ2InLCBwcm9wcy5lbWFpbCkpLFxuICAgIF0pIDogbnVsbCxcbiAgICBoKEJveCwge2dhcDogOH0sIFtcbiAgICAgIGgoJ2g0JywgYENvcHkgdGhlIGNvZGUgdGhlcmUgYW5kIHN1Ym1pdCBpdCBoZXJlOmApLFxuICAgICAgaChJbnB1dCwge1xuICAgICAgICBzcGVsbENoZWNrOiBmYWxzZSxcbiAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICB2YWx1ZToga2V5LFxuICAgICAgICBvbkNoYW5nZTogZT0+c2V0S2V5KGUuY3VycmVudFRhcmdldC52YWx1ZS50cmltKCkpXG4gICAgICB9KVxuICAgIF0pLFxuICAgIHN0YXR1cyA9PT0gJ2Vycm9yJyA/IGgoRXJyb3IsIHt9LCBbXG4gICAgICAnWW91ciBlbWFpbCBsaW5rIGlzIGludmFsaWQgb3Igb3V0IG9mIGRhdGUsIHBsZWFzZSB0cnkgJyxcbiAgICAgIGgoTGluaywge2hyZWY6Jy9zaWdudXAnfSwgaCgnYScsICdzaWduaW5nIHVwIGFnYWluJyApKSwgJy4nXG4gICAgXSkgOiBudWxsLFxuICAgIGgoUHJpbWFyeSwge3R5cGU6ICdzdWJtaXQnLCBzdGF0dXMsIHN0eWxlOntqdXN0aWZ5U2VsZjogJ3JpZ2h0J319LCBcIkNvbmZpcm0geW91ciBlbWFpbFwiKVxuICBdKVxufVxuXG5leHBvcnQgY29uc3QgU2lnblVwSGVhZGVyID0gc3R5bGVkKCdkaXYnKSBgXG4gIGRpc3BsYXk6Z3JpZDtcbiAgZ3JpZC1nYXA6MTZweDtcbiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAgYXV0byBtaW4tY29udGVudDtcbiAgYWxpZ24taXRlbXM6IGVuZDtcbmBcblxuZXhwb3J0IGRlZmF1bHQgU2lnbnVwXG4iXX0= */\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n});\nexport default Signup;","map":{"version":3,"sources":["/Users/ayooluwaalfonso/code/krakeneduapp/pages/signup.ts"],"names":["h","useState","useEffect","useRouter","Link","Box","LabelBox","FormBox","Input","Error","Info","CheckBox","PasswordInput","Primary","AccentImg","HalfLoopImg","useUserData","callApi","useApi","useDebouncedEffect","usernameValidate","COPY","submitButton","headerDescription","Signup","formData","setFormData","email","username","password","newsletter","status","callSignupRequest","router","push","usernameValid","setUsernameValid","data","user","res","onSubmit","e","preventDefault","query","verifyEmail","undefined","VerifyEmail","resendEmail","width","ma","gap","SignUpHeader","src1","src2","alt","startLoop","href","type","name","required","minLength","maxLength","value","onChange","currentTarget","setCustomValidity","length","checked","style","justifySelf","props","key","setKey","callSignupVerify","setTimeout","src","spellCheck","trim"],"mappings":";;;;;;;;;;AAAA,OAAOA,CAAP,MAAc,mBAAd;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAAQC,SAAR,QAAwB,aAAxB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AAEA,SAASC,GAAT,EAAcC,QAAd,EAAwBC,OAAxB,QAAsC,mBAAtC;AACA,SAASC,KAAT,EAAgBC,KAAhB,EAAuBC,IAAvB,EAA6BC,QAA7B,EAAuCC,aAAvC,QAA2D,iBAA3D;AACA,SAASC,OAAT,QAAwB,mBAAxB;AACA,SAAQC,SAAR,EAAmBC,WAAnB,QAAqC,mBAArC;AACA,SAASC,WAAT,QAA4B,UAA5B;AACA,SAASC,OAAT,EAAkBC,MAAlB,QAAgC,gBAAhC;AACA,SAASC,kBAAT,QAAkC,WAAlC;AAIA,SAASC,gBAAT,QAAiC,WAAjC;AAEA,MAAMC,IAAI,GAAG;AACXC,EAAAA,YAAY,EAAE,qBADH;AAEXC,EAAAA,iBAAiB,EACf;AAHS,CAAb;;AAMA,MAAMC,MAAM,GAAG,MAAM;AACnB,MAAI;AAAA,OAACC,QAAD;AAAA,OAAWC;AAAX,MAA0BzB,QAAQ,CAAC;AACrC0B,IAAAA,KAAK,EAAC,EAD+B;AAErCC,IAAAA,QAAQ,EAAE,EAF2B;AAGrCC,IAAAA,QAAQ,EAAC,EAH4B;AAIrCC,IAAAA,UAAU,EAAE;AAJyB,GAAD,CAAtC;AAOA,MAAI,CAACC,MAAD,EAASC,iBAAT,IAA8Bd,MAAM,CAA4B,CAACO,QAAD,CAA5B,EAAwC,MAAKQ,MAAM,CAACC,IAAP,CAAY,qBAAZ,CAA7C,CAAxC;AACA,MAAI;AAAA,OAACC,aAAD;AAAA,OAAgBC;AAAhB,MAAoCnC,QAAQ,CAAiB,IAAjB,CAAhD;AACA,MAAI;AAACoC,IAAAA,IAAI,EAACC;AAAN,MAActB,WAAW,EAA7B;AACA,MAAIiB,MAAM,GAAG9B,SAAS,EAAtB;AAEAD,EAAAA,SAAS,CAAC,MAAI;AAAC,QAAGoC,IAAH,EAASL,MAAM,CAACC,IAAP,CAAY,YAAZ;AAA0B,GAAzC,EAA2C,CAACI,IAAD,CAA3C,CAAT;AACAnB,EAAAA,kBAAkB,CAAC,YAAU;AAC3B,QAAG,CAACM,QAAQ,CAACG,QAAb,EAAuB,OAAOQ,gBAAgB,CAAC,IAAD,CAAvB;AACvB,QAAG,CAAChB,gBAAgB,CAACK,QAAQ,CAACG,QAAV,CAApB,EAAyC,OAAOQ,gBAAgB,CAAC,IAAD,CAAvB;AACzC,QAAIG,GAAG,GAAG,MAAMtB,OAAO,CAA4B,uBAAqBQ,QAAQ,CAACG,QAA1D,CAAvB;AACA,QAAGW,GAAG,CAACR,MAAJ,KAAa,GAAhB,EAAqBK,gBAAgB,CAAC,IAAD,CAAhB,CAArB,KACKA,gBAAgB,CAAC,KAAD,CAAhB;AACN,GANiB,EAMf,GANe,EAMV,CAACX,QAAQ,CAACG,QAAV,CANU,CAAlB;;AAQA,QAAMY,QAAQ,GAAG,MAAOC,CAAP,IAA6B;AAC5CA,IAAAA,CAAC,CAACC,cAAF;AACA,UAAMV,iBAAiB,CAAC,qBAAD,EAAwBP,QAAxB,CAAvB;AACD,GAHD;;AAKA,MAAGQ,MAAM,CAACU,KAAP,CAAaC,WAAb,KAA6BC,SAAhC,EAA2C;AACzC,WAAO7C,CAAC,CAAC8C,WAAD,EAAc;AAACnB,MAAAA,KAAK,EAAEF,QAAQ,CAACE,KAAjB;AAAwBoB,MAAAA,WAAW,EAAEP;AAArC,KAAd,CAAR;AACD;;AAED,SAAOxC,CAAC,CAACO,OAAD,EAAU;AAACiC,IAAAA,QAAD;AAAWQ,IAAAA,KAAK,EAAE,GAAlB;AAAuBC,IAAAA,EAAE,EAAE,IAA3B;AAAiCC,IAAAA,GAAG,EAAE;AAAtC,GAAV,EAAqD,CAC3DlD,CAAC,CAACK,GAAD,EAAM;AAAC6C,IAAAA,GAAG,EAAC;AAAL,GAAN,EAAe,CACdlD,CAAC,CAACmD,YAAD,EAAe,CACdnD,CAAC,CAAC,IAAD,EAAO,SAAP,CADa,EAEdA,CAAC,CAACe,WAAD,EAAc;AACbqC,IAAAA,IAAI,EAAE,qBADO;AAEbC,IAAAA,IAAI,EAAE,qBAFO;AAGbC,IAAAA,GAAG,EAAE,wCAHQ;AAIbC,IAAAA,SAAS,EAAE;AAJE,GAAd,CAFa,CAAf,CADa,EAUdvD,CAAC,CAAC,OAAD,EAAUqB,IAAI,CAACE,iBAAf,CAVa,EAWdvB,CAAC,CAAC,iBAAD,EAAoB,CAAC,KAAD,EAAQA,CAAC,CAACI,IAAD,EAAO;AAACoD,IAAAA,IAAI,EAAC;AAAN,GAAP,EAAwBxD,CAAC,CAAC,GAAD,EAAM,QAAN,CAAzB,CAAT,EAAoD,4BAApD,CAApB,CAXa,CAAf,CAD0D,EAc3D+B,MAAM,KAAK,OAAX,GAAqB/B,CAAC,CAACS,KAAD,EAAQ,EAAR,EAAYT,CAAC,CAAC,KAAD,EAAQ,CACzC,6CADyC,EACMA,CAAC,CAACI,IAAD,EAAM;AAACoD,IAAAA,IAAI,EAAC;AAAN,GAAN,EAAuBxD,CAAC,CAAC,GAAD,EAAM,YAAN,CAAxB,CADP,EAEzC,GAFyC,CAAR,CAAb,CAAtB,GAGM,IAjBqD,EAkB3DA,CAAC,CAACM,QAAD,EAAW;AAAC4C,IAAAA,GAAG,EAAC;AAAL,GAAX,EAAmB,CAClBlD,CAAC,CAAC,KAAD,EAAQ,CACPA,CAAC,CAAC,IAAD,EAAO,UAAP,CADM,EAEPA,CAAC,CAAC,qBAAD,EAAwB,iDAAxB,CAFM,CAAR,CADiB,EAKlBA,CAAC,CAACQ,KAAD,EAAQ;AACPiD,IAAAA,IAAI,EAAE,MADC;AAEPC,IAAAA,IAAI,EAAE,UAFC;AAGPC,IAAAA,QAAQ,EAAE,IAHH;AAIPC,IAAAA,SAAS,EAAE,CAJJ;AAKPC,IAAAA,SAAS,EAAE,EALJ;AAMPC,IAAAA,KAAK,EAAErC,QAAQ,CAACG,QANT;AAOPmC,IAAAA,QAAQ,EAAGtB,CAAD,IAAM;AACdf,MAAAA,WAAW,iCAAKD,QAAL;AAAeG,QAAAA,QAAQ,EAACa,CAAC,CAACuB,aAAF,CAAgBF;AAAxC,SAAX;;AACA,UAAG,CAAC1C,gBAAgB,CAACqB,CAAC,CAACuB,aAAF,CAAgBF,KAAhB,IAAyB,EAA1B,CAApB,EAAkD;AAChDrB,QAAAA,CAAC,CAACuB,aAAF,CAAgBC,iBAAhB,CAAkC,kFAAlC;AACD,OAFD,MAGK;AACHxB,QAAAA,CAAC,CAACuB,aAAF,CAAgBC,iBAAhB,CAAkC,EAAlC;AACD;AACF;AAfM,GAAR,CALiB,EAqBlBxC,QAAQ,CAACG,QAAT,CAAkBsC,MAAlB,GAA2B,CAA3B,GAA+B,IAA/B,GACE,CAAC9C,gBAAgB,CAACK,QAAQ,CAACG,QAAV,CAAjB,GAAuC5B,CAAC,CAAC,gBAAD,EAAmB,kFAAnB,CAAxC,GACAmC,aAAa,KAAK,IAAlB,GACE,EADF,GAEEA,aAAa,GAAGnC,CAAC,CAAC,oBAAD,EAAuB,oCAAvB,CAAJ,GAAmEA,CAAC,CAAC,gBAAD,EAAmB,gCAAnB,CAzBnE,CAAnB,CAlB0D,EA6C3DA,CAAC,CAACM,QAAD,EAAW;AAAC4C,IAAAA,GAAG,EAAC;AAAL,GAAX,EAAoB,CACnBlD,CAAC,CAAC,KAAD,EAAQ,CACPA,CAAC,CAAC,IAAD,EAAO,YAAP,CADM,EAEPA,CAAC,CAAC,qBAAD,EAAwB,yCAAxB,CAFM,CAAR,CADkB,EAKnBA,CAAC,CAACQ,KAAD,EAAQ;AAACiD,IAAAA,IAAI,EAAE,OAAP;AACCC,IAAAA,IAAI,EAAE,OADP;AAECC,IAAAA,QAAQ,EAAE,IAFX;AAGCG,IAAAA,KAAK,EAAErC,QAAQ,CAACE,KAHjB;AAICoC,IAAAA,QAAQ,EAAGtB,CAAD,IAAMf,WAAW,iCAAKD,QAAL;AAAeE,MAAAA,KAAK,EAACc,CAAC,CAACuB,aAAF,CAAgBF;AAArC;AAJ5B,GAAR,CALkB,CAApB,CA7C0D,EAwD3D9D,CAAC,CAACM,QAAD,EAAW;AAAC4C,IAAAA,GAAG,EAAC;AAAL,GAAX,EAAoB,CACnBlD,CAAC,CAAC,KAAD,EAAQ,CACPA,CAAC,CAAC,IAAD,EAAO,UAAP,CADM,EAEPA,CAAC,CAAC,qBAAD,EAAwB,6BAAxB,CAFM,CAAR,CADkB,EAKnBA,CAAC,CAACY,aAAD,EAAgB;AACP8C,IAAAA,IAAI,EAAE,cADC;AAEPC,IAAAA,QAAQ,EAAE,IAFH;AAGPC,IAAAA,SAAS,EAAE,CAHJ;AAIPE,IAAAA,KAAK,EAAErC,QAAQ,CAACI,QAJT;AAKPkC,IAAAA,QAAQ,EAAGtB,CAAD,IAAMf,WAAW,iCAAKD,QAAL;AAAeI,MAAAA,QAAQ,EAACY,CAAC,CAACuB,aAAF,CAAgBF;AAAxC;AALpB,GAAhB,CALkB,CAApB,CAxD0D,EAoE3D9D,CAAC,CAACM,QAAD,EAAW;AAAC4C,IAAAA,GAAG,EAAC;AAAL,GAAX,EAAoB,CACnBlD,CAAC,CAAC,KAAD,EAAQ,CACPA,CAAC,CAAC,IAAD,EAAO,oBAAP,CADM,EAEPA,CAAC,CAAC,qBAAD,EAAwB,mGAAxB,CAFM,CAAR,CADkB,EAKnBA,CAAC,CAACW,QAAD,EAAW,CACVX,CAAC,CAACQ,KAAD,EAAQ;AAACiD,IAAAA,IAAI,EAAE,UAAP;AAAmBC,IAAAA,IAAI,EAAE,YAAzB;AAAuCS,IAAAA,OAAO,EAAE1C,QAAQ,CAACK,UAAzD;AAAqEiC,IAAAA,QAAQ,EAAEtB,CAAC,IAAG;AAC1Ff,MAAAA,WAAW,iCAAKD,QAAL;AAAeK,QAAAA,UAAU,EAAEW,CAAC,CAACuB,aAAF,CAAgBG;AAA3C,SAAX;AACD;AAFQ,GAAR,CADS,EAIV,0BAJU,CAAX,CALkB,CAApB,CApE0D,EAgF3DnE,CAAC,CAACa,OAAD,EAAU;AAACkB,IAAAA,MAAD;AAASqC,IAAAA,KAAK,EAAE;AAACC,MAAAA,WAAW,EAAE;AAAd,KAAhB;AAAsCZ,IAAAA,IAAI,EAAE;AAA5C,GAAV,EAAiEpC,IAAI,CAACC,YAAtE,CAhF0D,CAArD,CAAR;AAkFD,CAjHD;;AAmHA,MAAMwB,WAAW,GAAIwB,KAAD,IAA+C;AACjE,MAAIrC,MAAM,GAAG9B,SAAS,EAAtB;AACA,MAAI;AAAA,OAACoE,GAAD;AAAA,OAAMC;AAAN,MAAgBvE,QAAQ,CAAC,EAAD,CAA5B;AACA,MAAI,CAAC8B,MAAD,EAAS0C,gBAAT,IAA6BvD,MAAM,CAAsC,CAACqD,GAAD,CAAtC,EAA6C,MAAI;AACtFG,IAAAA,UAAU,CAAC,MAAI;AACbzC,MAAAA,MAAM,CAACC,IAAP,CAAY,YAAZ;AACD,KAFS,EAEP,IAFO,CAAV;AAGD,GAJsC,CAAvC;;AAMA,QAAMM,QAAQ,GAAG,MAAOC,CAAP,IAA4B;AAC3CA,IAAAA,CAAC,CAACC,cAAF;AACA,UAAM+B,gBAAgB,CAAC,oBAAD,EAAuB;AAACF,MAAAA;AAAD,KAAvB,CAAtB;AACD,GAHD;;AAKArE,EAAAA,SAAS,CAAC,MAAI;AACZ,QAAG+B,MAAM,CAACU,KAAP,CAAaC,WAAb,IAA4B,OAAOX,MAAM,CAACU,KAAP,CAAaC,WAApB,KAAoC,QAAnE,EAA6E;AAC3E6B,MAAAA,gBAAgB,CAAC,oBAAD,EAAuB;AAACF,QAAAA,GAAG,EAACtC,MAAM,CAACU,KAAP,CAAaC;AAAlB,OAAvB,CAAhB;AACD;AACF,GAJQ,EAIN,EAJM,CAAT;AAMA,MAAGX,MAAM,CAACU,KAAP,CAAaC,WAAb,IAA4Bb,MAAM,KAAK,IAA1C,EAAgD,OAAO,IAAP;AAEhD,MAAGA,MAAM,KAAK,SAAd,EAAyB,OAAO/B,CAAC,CAACK,GAAD,EAAM;AAAE2C,IAAAA,KAAK,EAAE,GAAT;AAAcC,IAAAA,EAAE,EAAE,IAAlB;AAAwBC,IAAAA,GAAG,EAAE;AAA7B,GAAN,EAAyC,CACxElD,CAAC,CAAC,IAAD,EAAO,WAAP,CADuE,EAExEA,CAAC,CACC,OADD,EAEC,qEAFD,CAFuE,EAMxEA,CAAC,CACCI,IADD,EAEC;AAAEoD,IAAAA,IAAI,EAAE;AAAR,GAFD,EAGCxD,CAAC,CAAC,GAAD,EAAM,EAAN,EAAUA,CAAC,CAACa,OAAD,EAAU,mBAAV,CAAX,CAHF,CANuE,CAAzC,CAAR;AAazB,SAAOb,CAAC,CAACO,OAAD,EAAU;AAACiC,IAAAA,QAAD;AAAWQ,IAAAA,KAAK,EAAE,GAAlB;AAAuBC,IAAAA,EAAE,EAAE,IAA3B;AAAiCC,IAAAA,GAAG,EAAE;AAAtC,GAAV,EAAqD,CAC3DlD,CAAC,CAACc,SAAD,EAAY;AAAC6D,IAAAA,GAAG,EAAE,gBAAN;AAAwBrB,IAAAA,GAAG,EAAE;AAA7B,GAAZ,CAD0D,EAE3DtD,CAAC,CAAC,IAAD,EAAO,mBAAP,CAF0D,EAG3DsE,KAAK,CAAC3C,KAAN,GAAc3B,CAAC,CAACK,GAAD,EAAM;AAAC6C,IAAAA,GAAG,EAAE;AAAN,GAAN,EAAgB,CAC5B,qDAD4B,EAE7BlD,CAAC,CAACU,IAAD,EAAO,EAAP,EAAWV,CAAC,CAAC,GAAD,EAAMsE,KAAK,CAAC3C,KAAZ,CAAZ,CAF4B,CAAhB,CAAf,GAGK,IANsD,EAO3D3B,CAAC,CAACK,GAAD,EAAM;AAAC6C,IAAAA,GAAG,EAAE;AAAN,GAAN,EAAgB,CACflD,CAAC,CAAC,IAAD,EAAQ,yCAAR,CADc,EAEfA,CAAC,CAACQ,KAAD,EAAQ;AACPoE,IAAAA,UAAU,EAAE,KADL;AAEPnB,IAAAA,IAAI,EAAE,MAFC;AAGPK,IAAAA,KAAK,EAAES,GAHA;AAIPR,IAAAA,QAAQ,EAAEtB,CAAC,IAAE+B,MAAM,CAAC/B,CAAC,CAACuB,aAAF,CAAgBF,KAAhB,CAAsBe,IAAtB,EAAD;AAJZ,GAAR,CAFc,CAAhB,CAP0D,EAgB3D9C,MAAM,KAAK,OAAX,GAAqB/B,CAAC,CAACS,KAAD,EAAQ,EAAR,EAAY,CAChC,wDADgC,EAEhCT,CAAC,CAACI,IAAD,EAAO;AAACoD,IAAAA,IAAI,EAAC;AAAN,GAAP,EAAyBxD,CAAC,CAAC,GAAD,EAAM,kBAAN,CAA1B,CAF+B,EAEwB,GAFxB,CAAZ,CAAtB,GAGK,IAnBsD,EAoB3DA,CAAC,CAACa,OAAD,EAAU;AAAC4C,IAAAA,IAAI,EAAE,QAAP;AAAiB1B,IAAAA,MAAjB;AAAyBqC,IAAAA,KAAK,EAAC;AAACC,MAAAA,WAAW,EAAE;AAAd;AAA/B,GAAV,EAAkE,oBAAlE,CApB0D,CAArD,CAAR;AAsBD,CAzDD;;AA2DA,OAAO,MAAMlB,YAAY,GAAG,qBAAO,KAAP;AAAA;AAAA,EAAH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAlB;AAOP,eAAe3B,MAAf","sourcesContent":["import h from 'react-hyperscript'\nimport { useState, useEffect } from 'react'\nimport {useRouter} from 'next/router'\nimport Link from 'next/link'\n\nimport { Box, LabelBox, FormBox} from 'components/Layout'\nimport { Input, Error, Info, CheckBox, PasswordInput} from 'components/Form'\nimport { Primary } from 'components/Button'\nimport {AccentImg, HalfLoopImg} from 'components/Images'\nimport { useUserData } from 'src/data'\nimport { callApi, useApi } from 'src/apiHelpers'\nimport { useDebouncedEffect} from 'src/hooks'\nimport { VerifyEmailMsg, SignupMsg, VerifyEmailResponse, SignupResponse} from 'pages/api/signup/[action]'\nimport { CheckUsernameResult } from 'pages/api/get/[...item]'\nimport styled from '@emotion/styled'\nimport { usernameValidate } from 'src/utils'\n\nconst COPY = {\n  submitButton: \"Create your account\",\n  headerDescription:\n    \"We're hyped for you to join the KrakenEdu community! Let's learn together.\",\n};\n\nconst Signup = () => {\n  let [formData, setFormData] = useState({\n    email:'',\n    username: '',\n    password:'',\n    newsletter: false,\n  })\n\n  let [status, callSignupRequest] = useApi<SignupMsg, SignupResponse>([formData], ()=> router.push('/signup?verifyEmail'))\n  let [usernameValid, setUsernameValid] = useState<null | boolean>(null)\n  let {data:user} = useUserData()\n  let router = useRouter()\n\n  useEffect(()=>{if(user) router.push('/dashboard')}, [user])\n  useDebouncedEffect(async ()=>{\n    if(!formData.username) return setUsernameValid(null)\n    if(!usernameValidate(formData.username)) return setUsernameValid(null)\n    let res = await callApi<null, CheckUsernameResult>('/api/get/username/'+formData.username)\n    if(res.status===404) setUsernameValid(true)\n    else setUsernameValid(false)\n  }, 500, [formData.username])\n\n  const onSubmit = async (e:React.FormEvent) => {\n    e.preventDefault()\n    await callSignupRequest('/api/signup/request', formData)\n  }\n\n  if(router.query.verifyEmail !== undefined) {\n    return h(VerifyEmail, {email: formData.email, resendEmail: onSubmit})\n  }\n\n  return h(FormBox, {onSubmit, width: 400, ma: true, gap: 32}, [\n    h(Box, {gap:8}, [\n      h(SignUpHeader, [\n        h('h1', 'Sign Up'),\n        h(HalfLoopImg, {\n          src1: '/img/sailboat-1.gif',\n          src2: '/img/sailboat-2.gif',\n          alt: \"an animated gif of a sailboat, boatin'\",\n          startLoop: 333,\n        }),\n      ]),\n      h('p.big', COPY.headerDescription),\n      h('p.textSecondary', ['Or ', h(Link, {href:\"/login\"}, h('a', 'log in')), ' with an existing account.'])\n    ]),\n    status === 'error' ? h(Error, {}, h('div', [\n      \"A user already exists with that email. Try \", h(Link,{href:'/login'}, h('a', 'logging in')),\n      '.'\n    ])) : null,\n    h(LabelBox, {gap:8},[\n      h('div', [\n        h('h4', \"Username\"),\n        h('small.textSecondary', \"Pick a unique username between 3-15 characters.\"),\n      ]),\n      h(Input, {\n        type: 'text',\n        name: \"username\",\n        required: true,\n        minLength: 3,\n        maxLength: 15,\n        value: formData.username,\n        onChange: (e)=> {\n          setFormData({...formData, username:e.currentTarget.value})\n          if(!usernameValidate(e.currentTarget.value || '')){\n            e.currentTarget.setCustomValidity('Your username must contain only letters, numbers, underscores, periods or dashes')\n          }\n          else {\n            e.currentTarget.setCustomValidity('')\n          }\n        }}),\n      formData.username.length < 3 ? null :\n        !usernameValidate(formData.username) ? h('span.accentRed', 'Your username must contain only letters, numbers, underscores, periods or dashes') :\n        usernameValid === null\n        ? ''\n        : usernameValid ? h('span.accentSuccess', 'Great! This username is available.') : h('span.accentRed', \"Sorry, that username is taken.\")\n    ]),\n    h(LabelBox, {gap:8}, [\n      h('div', [\n        h('h4', \"Your Email\"),\n        h('small.textSecondary', \"You'll have to verify this in a moment.\"),\n      ]),\n      h(Input, {type: 'email',\n                name: 'email',\n                required: true,\n                value: formData.email,\n                onChange: (e)=> setFormData({...formData, email:e.currentTarget.value})})\n    ]),\n    h(LabelBox, {gap:8}, [\n      h(\"div\", [\n        h('h4', \"Password\"),\n        h('small.textSecondary', \"Minimum length 8 characters\"),\n      ]),\n      h(PasswordInput, {\n                name: \"new-password\",\n                required: true,\n                minLength: 8,\n                value: formData.password,\n                onChange: (e)=> setFormData({...formData, password:e.currentTarget.value})})\n    ]),\n    h(LabelBox, {gap:8}, [\n      h('div', [\n        h('h4', \"Get email updates?\"),\n        h('small.textSecondary', \"We send out occasional updates on new courses and features. We'll never spam or share your email.\"),\n      ]),\n      h(CheckBox, [\n        h(Input, {type: 'checkbox', name: 'newsletter', checked: formData.newsletter, onChange: e=> {\n          setFormData({...formData, newsletter: e.currentTarget.checked})\n        }}),\n        \"Sure! Gimme the updates.\"\n      ]),\n    ]),\n    h(Primary, {status, style: {justifySelf: 'end'}, type: 'submit'}, COPY.submitButton),\n  ])\n}\n\nconst VerifyEmail = (props: {email?:string, resendEmail: any}) =>  {\n  let router = useRouter()\n  let [key, setKey] = useState('')\n  let [status, callSignupVerify] = useApi<VerifyEmailMsg, VerifyEmailResponse>([key], ()=>{\n    setTimeout(()=>{\n      router.push('/dashboard')\n    }, 3000)\n  })\n\n  const onSubmit = async (e: React.FormEvent)=>{\n    e.preventDefault()\n    await callSignupVerify('/api/signup/verify', {key})\n  }\n\n  useEffect(()=>{\n    if(router.query.verifyEmail && typeof router.query.verifyEmail === 'string') {\n      callSignupVerify('/api/signup/verify', {key:router.query.verifyEmail})\n    }\n  }, [])\n\n  if(router.query.verifyEmail && status === null) return null\n\n  if(status === 'success') return h(Box, { width: 400, ma: true, gap: 16 }, [\n    h(\"h1\", \"All Done!\"),\n    h(\n      \"p.big\",\n      \"Click the button below if you're not redirected in a couple seconds\"\n    ),\n    h(\n      Link,\n      { href: \"/dashboard\" },\n      h(\"a\", {}, h(Primary, \"Back to Krakenedu\"))\n    ),\n  ]);\n\n  return h(FormBox, {onSubmit, width: 400, ma: true, gap: 32}, [\n    h(AccentImg, {src: '/img/plane.gif', alt: \"an animated gif of a paper airplane taking off\" }),\n    h('h1', 'Verify your email'),\n    props.email ? h(Box, {gap: 8}, [\n      `Sweet! We sent an email with a verification code to`,\n      h(Info, {}, h('b', props.email)),\n    ]) : null,\n    h(Box, {gap: 8}, [\n      h('h4', `Copy the code there and submit it here:`),\n      h(Input, {\n        spellCheck: false,\n        type: 'text',\n        value: key,\n        onChange: e=>setKey(e.currentTarget.value.trim())\n      })\n    ]),\n    status === 'error' ? h(Error, {}, [\n      'Your email link is invalid or out of date, please try ',\n      h(Link, {href:'/signup'}, h('a', 'signing up again' )), '.'\n    ]) : null,\n    h(Primary, {type: 'submit', status, style:{justifySelf: 'right'}}, \"Confirm your email\")\n  ])\n}\n\nexport const SignUpHeader = styled('div') `\n  display:grid;\n  grid-gap:16px;\n  grid-template-columns:  auto min-content;\n  align-items: end;\n`\n\nexport default Signup\n"]},"metadata":{},"sourceType":"module"}