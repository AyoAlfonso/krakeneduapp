{"version":3,"sources":["webpack://_N_E/./components/Pill.ts","webpack://_N_E/./components/Course/WatchCourse.ts","webpack://_N_E/./components/Images.ts"],"names":["Pill","props","red","colors","accentRed","textSecondary","borderOnly","grey55","grey90","WatchCourse","useUserCourses","userCourses","data","mutate","user","useUserData","watching","watching_courses","find","c","course","id","useState","loading","setLoading","h","EmailWatching","WatchCourseBox","Icon","src","LinkButton","onClick","e","a","preventDefault","callApi","res","status","filter","x","email","Loader","WatchCourseInline","open","setOpen","useDebouncedEffect","Fragment","Modal","display","onExit","EmailWatchingModal","WatchCourseInlineButton","Bell","blue","setWatching","setEmail","onSubmit","Box","gap","style","textAlign","AccentImg","alt","margin","FormBox","Input","value","type","placeholder","onChange","currentTarget","Primary","disabled","justifySelf","height","width","HalfLoopImg","looping","setLooping","imageRef","useRef","useEffect","current","complete","setTimeout","startLoop","src2","ref","onLoad","src1"],"mappings":"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","file":"static/chunks/55ee02187d9ea1a38a94bb124333fe45e8ad86e1.103aac0863169038f9e4.js","sourcesContent":["import styled from '@emotion/styled'\nimport {colors} from './Tokens'\nexport const Pill = styled('span')<{borderOnly?: boolean, red?: boolean}>`\nheight: min-content;\nwidth: fit-content;\nfont-weight: bold;\nfont-family: Roboto Mono;\npadding: 2px 8px;\nfont-size: 0.75rem;\nborder-radius: 4px;\ncolor: ${props => props.red ? colors.accentRed : colors.textSecondary};\n${props=> props.borderOnly\n? `border: 2px solid ${props.red ? colors.accentRed : colors.grey55};`\n: `background-color: ${colors.grey90};`\n}\n`\n","import styled from '@emotion/styled'\nimport h from 'react-hyperscript'\nimport { Fragment, useState } from 'react'\n\nimport { useUserData, useUserCourses } from 'src/data'\nimport { WatchCourseMsg, WatchCourseResult } from 'pages/api/courses/[id]/watch'\nimport { callApi } from 'src/apiHelpers'\nimport Loader  from 'components/Loader'\nimport { Box, FormBox } from 'components/Layout'\nimport {Bell} from 'components/Icons'\nimport { Input } from 'components/Form'\nimport { LinkButton, Primary } from 'components/Button'\nimport { useDebouncedEffect } from 'src/hooks'\nimport { Modal } from 'components/Modal'\nimport { AccentImg } from 'components/Images'\n\nexport function WatchCourse(props:{id: number}) {\n  let {data: userCourses, mutate} = useUserCourses()\n  let {data: user} = useUserData()\n  let watching = userCourses?.watching_courses.find(c=> c.course === props.id)\n  let [loading, setLoading] = useState(false)\n\n  // Should probably throttle toggles to this at some point!\n  if(user===false) return h(EmailWatching, props)\n  return h(WatchCourseBox, [\n    h(Icon, {src: watching ? '/img/watching.png' : '/img/not-watching.png'}),\n    h(\"div\", [\n      h('p', [watching ? \"You get emails about new cohorts!\" : \"Want emails on new cohorts?\"]),\n      h(LinkButton, {onClick:async (e: React.MouseEvent)=>{\n        e.preventDefault()\n        if(loading || !user || !userCourses) return\n        setLoading(true)\n        let res = await callApi<WatchCourseMsg, WatchCourseResult>(`/api/courses/${props.id}/watch`, {watching: !watching})\n        setLoading(false)\n        if(res.status === 200) {\n          if(watching) mutate({...userCourses, watching_courses: userCourses.watching_courses.filter(x=>x.course !== props.id)})\n          else mutate({...userCourses, watching_courses: [...userCourses.watching_courses, {course: props.id, email: user.email}]})\n        }\n      }}, loading ? h(Loader) : watching? \"Unsubscribe?\" : \"Subscribe!\" )\n    ])\n  ])\n}\n\n// This component appears at the bottom of course and club listings. \nexport function WatchCourseInline(props:{id:number}) {\n  let {data: userCourses, mutate} = useUserCourses()\n  let {data: user} = useUserData()\n  let [open, setOpen] = useState(false)\n  let watching = userCourses?.watching_courses.find(c=> c.course === props.id)\n\n  useDebouncedEffect(async ()=>{\n    await callApi<WatchCourseMsg, WatchCourseResult>(`/api/courses/${props.id}/watch`, {watching: !!watching})\n  }, 500, [watching])\n\n  const onClick = async (e:React.MouseEvent)=>{\n    e.preventDefault()\n    if(!user || !userCourses) return setOpen(true)\n    if(watching) mutate({...userCourses, watching_courses: userCourses.watching_courses.filter(x=>x.course !== props.id)}, false)\n    else mutate({...userCourses, watching_courses: [...userCourses.watching_courses, {course: props.id, email: user.email}]}, false)\n  }\n\n  // Should probably throttle toggles to this at some point!\n  return h(Fragment, [\n    h(Modal, {display: open, onExit:()=>setOpen(false)}, [\n      h(EmailWatchingModal, props)\n    ]),\n    h(WatchCourseInlineButton, {onClick}, [\n      h(Bell, {blue: !!watching}),\n      h('small.textSecondary', [watching ? \"You get updates about this course!\" : h('span', [h('u', \"Get updates\",), \" on new cohorts\"])])\n    ])\n  ])\n}\n\nconst WatchCourseInlineButton = styled('button')`\nborder: none;\nbackground-color: inherit;\nfont-family: inherit;\nfont-size: inherit;\ndisplay: grid;\ngrid-gap: 8px;\npadding: 0;\ngrid-template-columns: min-content auto;\n&:hover {\n  cursor: pointer;\n  small {\n    color: blue;\n  }\n  path, svg {\n    fill: blue;\n  }\n}\n&:focus {\n  outline: none;\n}\n\ntext-align: left;\n`\n\n// Inline Watch Button pops this modal to collect emails for users who are not logged in \nlet EmailWatchingModal = (props: {id:number}) => {\n  let [watching, setWatching] = useState(false)\n  let [email, setEmail] = useState('')\n  let [loading, setLoading] = useState(false)\n\n  const onSubmit = async (e:React.FormEvent) =>{\n    e.preventDefault()\n    if(loading || !email) return\n    setLoading(true)\n    let res = await callApi<WatchCourseMsg, WatchCourseResult>(`/api/courses/${props.id}/watch`, {watching: !watching, email: email})\n    setLoading(false)\n    if(res.status === 200) {\n      setWatching(true)\n    }\n  }\n\n  return  h(Box, {gap: 16}, [\n    h('div', {style:{textAlign:'center'}}, [watching \n      ? h(Box, [h(AccentImg, {src: '/img/success.gif', alt: \"A little dragon who is happy for you!\", style:{margin:'auto auto'}}),\n        h('b', \"Thanks! We'll email you as soon as there's a new cohort!\"), \n      ])\n      : h('b', \"Leave your email for updates on new cohorts of this course\"),\n    ]),\n    watching ? null : h(FormBox, {onSubmit}, [\n      h(Input, {value:email, type: 'email', placeholder: 'your email', onChange:(e)=>setEmail(e.currentTarget.value)}),\n      h(Primary, {type: 'submit', disabled: !email, style:{justifySelf:'center'}}, loading ? h(Loader) : \"Subscribe\" )\n    ])\n  ])\n\n}\n// END Inline Watch Button Modal\n\n// END Inline Watch Button\n\nlet EmailWatching = (props:{id: number})=>{\n  let [watching, setWatching] = useState(false)\n  let [email, setEmail] = useState('')\n  let [loading, setLoading] = useState(false)\n\n  const onSubmit = async (e:React.FormEvent) =>{\n    e.preventDefault()\n    if(loading || !email) return\n    setLoading(true)\n    let res = await callApi<WatchCourseMsg, WatchCourseResult>(`/api/courses/${props.id}/watch`, {watching: !watching, email: email})\n    setLoading(false)\n    if(res.status === 200) {\n      setWatching(true)\n    }\n  }\n  return h(WatchCourseBox, [\n    h(Icon, {src: watching ? '/img/watching.png' : '/img/not-watching.png'}),\n    h(Box, {gap: 8}, [\n      h('b', [watching ? \"You get emails about new cohorts!\" : \"Email me when new cohorts are scheduled\"]),\n      watching ? null : h(FormBox, {gap:8, onSubmit}, [\n        h(Input, {value:email, type: 'email', placeholder: 'your email', onChange:(e)=>setEmail(e.currentTarget.value)}),\n        h(LinkButton, {type: 'submit', style:{justifySelf:'right'}}, loading ? h(Loader) : \"subscribe\" )\n      ])\n    ])\n  ])\n}\n\nconst Icon = styled('img')`\nimage-rendering: pixelated;\nimage-rendering: -moz-crisp-edges;\nimage-rendering: crisp-edges;\n`\n\nconst WatchCourseBox = styled('div')`\nmax-width: 300px;\ndisplay: grid;\ngrid-gap: 16px;\ngrid-template-columns: min-content auto;\n`\n","import styled from '@emotion/styled'\nimport { useState, useEffect, useRef } from 'react'\nimport h from 'react-hyperscript'\n\nexport let TitleImg = styled('img')<{height?: number, width: number}>`\nimage-rendering: pixelated;\nimage-rendering: crisp-edges;\ndisplay: block;\nborder: 2px solid;\nheight: ${props=> props.height ? props.height +'px' : 'auto'};\nwidth: ${props=> props.width}px;\n`\n\nexport let AccentImg = styled('img')<{height?: number, width?: number}>`\nimage-rendering: pixelated;\nimage-rendering: -moz-crisp-edges;\nimage-rendering: crisp-edges;\ndisplay: block;\nborder: none;\nheight: ${props=> props.height ? props.height +'px' : '100px'};\nwidth: ${props=> props.width ? props.width +'px' : '100px'};\n`\n\nexport function HalfLoopImg(props:\n    {\n        src1:string,\n        src2:string,\n        alt:string,\n        startLoop:number,\n    }) {\n    let [looping, setLooping] = useState(false)\n    let imageRef = useRef<HTMLImageElement>(null)\n    useEffect(()=> {\n      if(imageRef.current?.complete && !looping) {\n        setTimeout(()=>setLooping(true), props.startLoop)\n      }\n    }, [])\n  \n    if(!looping) {\n      return h(AccentImg, {ref: imageRef, onLoad: () => {\n        setTimeout(()=>setLooping(true), props.startLoop)\n      }, src: props.src1, alt: props.alt })\n    }\n    return h(AccentImg, {src: props.src2, alt: props.alt })\n  }"],"sourceRoot":""}