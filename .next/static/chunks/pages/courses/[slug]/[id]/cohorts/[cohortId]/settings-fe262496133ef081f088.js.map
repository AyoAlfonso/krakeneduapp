{"version":3,"sources":["webpack://_N_E/./pages/404.ts","webpack://_N_E/./node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?0e08","webpack://_N_E/./pages/courses/[slug]//cohorts/[cohortId]/settings.ts","webpack://_N_E/./components/Tabs.ts"],"names":["user","useUserData","data","h","Box","style","textAlign","width","margin","Link","href","window","__NEXT_P","push","WrappedSettingsPage","props","notFound","ErrorPage","CohortSettingsPage","useCohortData","cohortId","cohort","mutate","router","useRouter","useEffect","undefined","cohort_facilitators","find","f","facilitator","id","gap","BackButton","courses","slug","cohortName","name","Tabs","tabs","Details","CohortDetails","PageLoader","start_date","Date","useFormData","description","getFullYear","getMonth","slice","getDate","start_time","toLocaleTimeString","hour","minute","hour12","state","form","reset","changed","useApi","status","callUpdateCohort","onSubmit","e","a","preventDefault","d1","split","map","x","parseInt","t1","toISOString","result","FormBox","LabelBox","Input","maxLength","Textarea","type","justifySelf","Destructive","disabled","onClick","Primary","Object","keys","filter","tab","selectedTab","query","StickyWrapper","Nav","Tab","active","route","URL","location","searchParams","set","replace","shallow","VerticalTabs","VerticalTab","selected","onChange","colors","appBackground","Mobile","p","withComponent"],"mappings":"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","file":"static/chunks/pages/courses/[slug]/[id]/cohorts/[cohortId]/settings-fe262496133ef081f088.js","sourcesContent":["import h from 'react-hyperscript'\nimport Link from 'next/link'\n\nimport {Box} from 'components/Layout'\nimport { useUserData } from 'src/data'\n\nexport default ()=>{\n  let {data: user} = useUserData()\n\n  return h(Box, {style: {textAlign: 'center', width: 'fit-content', margin: 'auto'}}, [\n    h('h1', '404'),\n    h('p', \"This page doesn't exist :(\"),\n    h('p', \"It could be bad link, or maybe we're just still working on it!\"),\n    h(Link, {href: user ? '/dashboard' : '/'}, h('a.mono', 'take me back to the homepage'))\n  ])\n}\n","\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/courses/[slug]/[id]/cohorts/[cohortId]/settings\",\n        function () {\n          return require(\"private-next-pages/courses/[slug]/[id]/cohorts/[cohortId]/settings.ts\");\n        }\n      ]);\n    ","import h from 'react-hyperscript'\nimport { InferGetStaticPropsType } from \"next\"\nimport { cohortDataQuery, UpdateCohortMsg, UpdateCohortResponse } from \"pages/api/cohorts/[cohortId]\"\nimport { getTaggedPost } from \"src/discourse\"\nimport ErrorPage from 'pages/404'\nimport { Box, FormBox, LabelBox } from 'components/Layout'\nimport { PageLoader } from 'components/Loader'\nimport { Cohort, useCohortData, useUserData } from 'src/data'\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/router'\nimport { BackButton, Primary, Destructive } from 'components/Button'\nimport { Tabs } from 'components/Tabs'\nimport { Input, Textarea } from 'components/Form'\nimport { useFormData } from 'src/hooks'\nimport { useApi } from 'src/apiHelpers'\nimport { cohortName } from 'src/utils'\n\ntype Props = InferGetStaticPropsType<typeof getStaticProps>\nexport default function WrappedSettingsPage(props:Props) {return props.notFound ? h(ErrorPage) : h(CohortSettingsPage, props)}\nconst CohortSettingsPage= (props: Extract<Props, {notFound:false}>) => {\n  let {data: user} = useUserData()\n  let {data: cohort, mutate} = useCohortData(props.cohortId, props.cohort)\n  let router = useRouter()\n  useEffect(()=>{\n    if(!props.cohort || user === undefined) return\n    else if(user===false) router.push('/')\n    else if(!props.cohort.cohort_facilitators.find(f=>user&&f.facilitator===user.id)) router.push('/dashboard')\n  },[user, props.cohort])\n  if(!cohort) return h(PageLoader)\n  return h(Box, {gap:64}, [\n    h(Box, [\n      h(BackButton, {href:`/courses/${props.cohort.courses.slug}/${props.cohort.courses.id}/cohorts/${props.cohort.id}`}, \"Cohort\"),\n      h('h1', \"Cohort Settings\"),\n      h('h4', cohortName(cohort.name))\n    ]),\n    h(Tabs, {tabs: {\n      Details: h(CohortDetails, {cohort, mutate}),\n    }\n    })\n  ])\n}\n\nfunction CohortDetails(props:{cohort:Cohort, mutate:(c:Cohort)=>void}) {\n  let start_date = new Date(props.cohort.start_date)\n  let {state, form, reset, changed} = useFormData({\n    name: props.cohort.name,\n    description: props.cohort.description,\n    start_date: `${start_date.getFullYear()}-${('0'+(start_date.getMonth()+1)).slice(-2)}-${('0'+start_date.getDate()).slice(-2)}`,\n    start_time: start_date.toLocaleTimeString([], {hour:\"2-digit\", minute: \"2-digit\", hour12: false}),\n  }, [props.cohort])\n\n  let [status, callUpdateCohort] = useApi<UpdateCohortMsg, UpdateCohortResponse>([])\n\n  const onSubmit = async (e:React.FormEvent)=>{\n    e.preventDefault()\n\n    let d1 = state.start_date.split('-').map(x=>parseInt(x))\n    let t1 = state.start_time.split(':').map(x=>parseInt(x))\n    let start_date = (new Date(d1[0], d1[1] -1, d1[2], t1[0], t1[1])).toISOString()\n    let result = await callUpdateCohort(`/api/cohorts/${props.cohort.id}`, {data: {\n      name: state.name,\n      description: state.description,\n      start_date\n    }})\n    if(result.status === 200) {\n      props.mutate({...props.cohort, ...result.result})\n    }\n  }\n\n  return h(FormBox, {width: 400, onSubmit}, [\n    h(LabelBox, {gap: 8}, [\n      h('h3', 'Cohort Name'),\n      h(Input, {maxLength: 50, ...form.name})\n    ]),\n    h(LabelBox, {gap:8}, [\n      h(\"div\", [\n        h('h4', 'Blurb'),\n        h('small', 'Describe your cohort in one or two sentences. ')\n      ]),\n      h(Textarea, {maxLength: 200, ...form.description})\n    ]),\n    h(LabelBox, {gap:8}, [\n      h('h4', \"Start Date\"),\n      h(Box, {h: true},[\n      h(Input, {type: \"date\", ...form.start_date}),\n      h(Input, {type: \"time\", ...form.start_time})\n      ])\n    ]),\n    h(Box, {h: true, style:{justifySelf:\"right\"}},[\n      h(Destructive, {disabled: !changed, onClick: (e)=>{\n        e.preventDefault()\n        reset()\n      }}, \"Discard Changes\"),\n        h(Primary, {type: 'submit', disabled: !changed, status}, 'Save Changes')\n    ])\n  ])\n}\n\nexport const getStaticProps = async (ctx:any)=>{\n  let cohortId = parseInt(ctx.params?.cohortId as string || '')\n  if(Number.isNaN(cohortId)) return {props:{notFound: true}} as const\n  let cohort = await cohortDataQuery(cohortId)\n\n  if(!cohort) return {props: {notFound: true}} as const\n\n  let cohort_events = cohort.cohort_events\n    .filter(c=>c.everyone)\n    .map(event =>{\n      return {...event, events: {...event.events, location: ''}}\n  })\n\n  let [notes] = await Promise.all([\n    getTaggedPost(cohort.category_id, 'note'),\n  ])\n  return {\n    props: {\n      notFound: false,\n      cohortId,\n      cohort: {...cohort, cohort_events},\n      notes,\n    },\n    revalidate: 1} as const\n}\n\nexport const getStaticPaths = () => {\n  return {paths:[], fallback: true}\n}\n","import { ReactElement} from 'react'\nimport h from 'react-hyperscript'\nimport styled from '@emotion/styled'\n\nimport {Box} from './Layout'\nimport { Mobile, colors } from './Tokens'\nimport { useRouter } from 'next/router'\n\ntype Props = {\n  tabs: {\n    [key: string]: ReactElement | null\n  }\n}\nexport const Tabs = (props:Props) => {\n  let router = useRouter()\n  let tabs = Object.keys(props.tabs).filter(tab => props.tabs[tab] !== null)\n  let selectedTab = typeof router.query.tab !== 'string' || !props.tabs[router.query.tab] ? tabs[0] : router.query.tab as string\n\n  return h(Box, {gap: 32}, [\n    h(StickyWrapper, [\n      h(Nav, tabs.map(tab => h(Tab, {\n        active: selectedTab === tab,\n        onClick: ()=> {\n          let route = new URL(window.location.href)\n          route.searchParams.set('tab', tab)\n          router.replace(route, undefined, {shallow: true})\n        }\n      }, tab))),\n    ]),\n    props.tabs[selectedTab]\n  ])\n}\n\nexport function VerticalTabs(props:{tabs: string[], selected: string, onChange: (tab: string)=>void}){\n  return h(Box, {}, props.tabs.map((tab) => {\n    return h(VerticalTab, {selected: props.selected === tab, onClick: ()=>props.onChange(tab)}, tab)\n  }))\n}\n\nexport const StickyWrapper = styled('div')`\nposition: sticky;\ntop: 0px;\nbackground-color: ${colors.appBackground};\nz-index: 1;\n\nmargin-top: -32px;\npadding-top: 32px;\n\n${Mobile} {\n  padding-top: 16px;\n  margin-top: -16px;\n}\n`\n\nconst Nav = styled('div')`\ndisplay: grid;\ngrid-gap: 32px;\ngrid-auto-columns: max-content;\ngrid-auto-flow: column;\ngrid-template-rows: auto;\nborder-bottom: 3px solid;\n\n${Mobile} {\n  grid-gap:16px;\n}\n`\n\nconst VerticalTab = styled('a')<{selected: boolean}>`\npadding-left: 12px;\nbox-sizing: border-box;\n&:hover {\ncursor: pointer;\n}\n${p=>p.selected ? `\ncolor: blue;\nfont-weight: bold;\nborder-collor: blue;\npadding-left: 8px;\nborder-left: solid 4px;\n` : \"\"}\n`\n\nconst Tab = styled('h4')<{active:boolean}>`\npadding-bottom: 4px;\nmargin-bottom: 2px;\nfont-weight: bold;\nz-index: 8;\n\n&:hover {\ncursor: pointer;\n}\n\n\n${props => props.active ? 'color: blue' : ''};\n${props => props.active ? 'border-bottom: 4px solid' : ''};\n`.withComponent('a')\n"],"sourceRoot":""}