_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[27],{ECPk:function(e,t,n){"use strict";n.r(t),n.d(t,"__N_SSG",(function(){return H}));var a=n("vJKn"),r=n.n(a),c=n("z7pX"),o=n("cpVT"),i=n("rg98"),s=n("xvhg"),u=n("wTIg"),l=n("j+1P"),p=n.n(l),d=n("20a2"),m=n("YFqc"),h=n.n(m),f=n("q1tI"),g=n("lnWS"),b=n("0CBl"),y=n("5++N"),v=n("kacE"),j=n("9Hbq"),O=n("rk+T"),w=n("Hzj1"),S=n("mirl");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){var t=Object(y.d)(e.course),n=t.data,a=t.mutate,r=Object(f.useState)({name:"",type:"absolute",limited_uses:!1,amount:0,max_redeems:void 0}),c=r[0],o=r[1],i=Object(b.b)([c,a],(function(e){n&&a(n.concat([e]))})),u=Object(s.a)(i,2),l=u[0],d=u[1];return p()(j.b,{gap:32},[p()(j.b,{width:640,padding:32,style:{backgroundColor:S.d.accentPeach}},[p()(j.d,{gap:32,onSubmit:function(t){t.preventDefault(),d("/api/courses/".concat(e.course,"/discounts"),c)},width:400},[p()("h3","Add a New Discount"),p()(j.e,{gap:8},[p()("h4","Discount Name"),p()(O.d,{type:"text",required:!0,value:c.name,onChange:function(e){return o(_(_({},c),{},{name:e.currentTarget.value}))}})]),p()(j.b,{h:!0,gap:64},[p()(j.e,{gap:8},[p()("h4","Type"),p()("div",{style:{alignSelf:"center",padding:"13px 0px"}},[p()(O.f,{h:!0,name:"type",selected:c.type,onChange:function(e){o(_(_({},c),{},{type:e}))},items:[{value:"percentage",component:p()("span","%")},{value:"absolute",component:p()("span","$")}]})])]),p()(j.e,{gap:8},[p()("h4","Amount Off"),p()(O.d,{type:"number",value:c.amount,onChange:function(e){return o(_(_({},c),{},{amount:parseInt(e.currentTarget.value)}))}})])]),p()(j.e,{gap:8},[p()("h4","Usage Restrictions"),p()(O.f,{name:"usage-restrictions",selected:c.limited_uses?"limited":"unlimited",onChange:function(e){o(_(_({},c),{},{limited_uses:"limited"===e}))},items:[{value:"unlimited",component:p()("p","Unlimited uses. Discount is valid until you cancel it")},{value:"limited",component:p()("p","Limited uses. Discount is only valid for a number of uses")}]})]),c.limited_uses?p()(j.e,{gap:8},[p()("h4","Max uses"),p()(O.d,{type:"number",value:c.max_redeems,onChange:function(e){o(_(_({},c),{},{max_redeems:parseInt(e.currentTarget.value)}))}})]):null,p()(w.f,{type:"submit",status:l},"Create New Discount")])]),p()("h2","Discounts"),p()("p","Copy the Share Links below and send them to people to offer them a discounted rate on your course!)"),n?p()(j.b,{gap:32},n.map((function(e){return p()("div",[p()(C,{discount:e,delete:function(){n&&a(n.filter((function(t){return t.code!==e.code})))}})])}))):p()(v.a)])}function C(e){var t=Object(f.useRef)(null),n=Object(b.b)([e],e.delete),a=Object(s.a)(n,2),r=a[0],c=a[1];return p()(j.b,{gap:8},[p()("h3",e.discount.name),p()("div",[p()("span.textSecondary","".concat("absolute"===e.discount.type?"$"+e.discount.amount:e.discount.amount+"%"," off")),p()("span.textSecondary"," | Redeemed ".concat(0===e.discount.max_redeems?e.discount.redeems:"".concat(e.discount.redeems,"/").concat(e.discount.max_redeems)," times"))]),p()(j.b,{h:!0,style:{alignItems:"center"}},[p()(O.d,{onFocus:function(e){e.currentTarget.selectionEnd=e.currentTarget.value.length},style:{width:"360px",textDecoration:"underline",color:"blue"},readOnly:!0,value:"https://app.krakenedu.com/discount?discount=".concat(e.discount.code),ref:t}),p()(w.g,{disabled:0!==e.discount.max_redeems&&e.discount.max_redeems<=e.discount.redeems,onClick:function(e){e.preventDefault(),t.current&&(t.current.select(),document.execCommand("copy"),t.current.selectionEnd=t.current.selectionStart,t.current.blur())}},"Copy"),p()(w.b,{status:r,onClick:function(t){t.preventDefault(),c("/api/discounts/"+e.discount.code,null,"DELETE")}},"Delete")])])}var E=n("+Xui"),D=n("mB65"),P=n("wyA/"),T=n("ptY8");var I=["https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Lightbulb.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Sparkle.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Picture.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Video.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/MusicNote.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Potion.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Plant.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Puzzle.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Chart.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/MoneyBag.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Camera.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Numbers.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Crayon.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/House.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Book.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Present.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Earth.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Shapes.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/Heart.png","https://hyperlink-data.nyc3.cdn.digitaloceanspaces.com/icons/EmojiSet/SpeechBubble.png"],N=function(e){var t=e.icons.filter((function(e){return!!e}));return p()(j.b,{width:400},[p()(q,I.map((function(n){return p()("img",{src:n,alt:n.split("/")[n.length-1],key:n,onClick:function(){var a=t.slice(0);3===a.length?a=[n]:a[a.length]=n,e.setIcons(a)}})}))),p()(j.b,{gap:8},[p()(A,t.map((function(e,t){return p()("img",{key:t,src:e})}))),p()(w.e,{style:{justifySelf:"right"},type:"reset",onClick:function(){e.setIcons([])}},"Clear")])])},q=Object(u.a)("div",{target:"e1ovbsl70"})({name:"1ug0e06",styles:"display:grid;grid-template-columns:repeat(auto-fill,32px);grid-gap:32px;"}),A=Object(u.a)("div",{target:"e1ovbsl71"})({name:"1likbx0",styles:"box-sizing:border-box;height:64px;background-color:white;display:grid;grid-template-columns:repeat(3,32px);justify-content:center;grid-gap:16px;padding:16px;width:100%;border:1px solid;"}),z=n("FPCx"),L=n("+ErQ");function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R={cancelCohort:p()("p.textSecondary",["Contact us at ",p()("a",{href:"mailto:contact@krakenedu.com"},"contact@krakenedu.com")," to cancel a cohort. Optionally,  let us know the reason you\u2019re cancelling (we\u2019re curious \ud83e\udd13)"])};function B(e){var t=Object(y.b)(e.id,e.course||void 0),n=t.data,a=t.mutate,r=Object(y.i)().data,c=Object(d.useRouter)();return Object(f.useEffect)((function(){void 0!==r&&(n&&(!!n.course_maintainers.find((function(e){return r&&e.maintainer===r.id}))||c.push("/")))}),[r,n]),n&&r?p()(j.b,{gap:64,width:640},[p()(j.b,{gap:16},[p()(w.a,{href:"/courses/[slug]/[id]",as:"/courses/".concat(c.query.slug,"/").concat(c.query.id)},"club"===n.type?"Club":"Course"),p()("h1","Settings"),p()("p.big",["KrakenEdu is new and some things can only be done manually for now! To add a new maintainer, remove a cohort, or anything else you don't see here, please email ",p()("a",{href:"mailto:help@krakenedu.com"},"help@krakenedu.com")])]),p()(g.b,{tabs:{Cohorts:p()(Y,{course:n,mutate:a}),Details:p()(K,{course:n,mutate:a}),Invites:p()(J,{course:n,mutate:a}),Templates:p()(G,{course:n,mutate:a}),Discounts:p()(x,{course:n.id})}})]):p()(v.a)}var H=!0;t.default=function(e){return e.notFound?p()(E.default):p()(B,e)};function Y(e){var t=Object(y.i)().data;return p()(j.b,{gap:32},[p()(X,e),p()(j.f),p()(j.b,{gap:16},[p()("h3","Cancel a Cohort"),R.cancelCohort]),p()(j.b,[p()("h3","All Cohorts"),p()(j.b,{gap:32},e.course.course_cohorts.map((function(n){var a=!!n.cohort_facilitators.find((function(e){return t&&e.facilitator===t.id}));return p()(T.Cohort,{cohort:n,enrolled:!1,facilitating:a,slug:e.course.slug,cohort_max_size:e.course.cohort_max_size,invited:!0})})))])])}var X=function(e){var t=Object(f.useState)({start_date:"",start_time:"",facilitators:[]}),n=t[0],a=t[1],o=Object(b.b)([n]),u=Object(s.a)(o,2),l=u[0],d=u[1],m=(new Date).toLocaleDateString("en-us",{timeZoneName:"short"}).split(", ")[1],h=function(){var t=Object(i.a)(r.a.mark((function t(a){var o,i,s,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),o=n.start_date.split("-").map((function(e){return parseInt(e)})),i=n.start_time.split(":").map((function(e){return parseInt(e)})),s=new Date(o[0],o[1]-1,o[2],i[0],i[1]),t.next=6,d("/api/cohorts",{courseId:e.course.id,facilitators:n.facilitators,start:s.toISOString()});case 6:200===(u=t.sent).status&&e.mutate(F(F({},e.course),{},{course_cohorts:[].concat(Object(c.a)(e.course.course_cohorts),[F(F({},u.result),{},{people_in_cohorts:[],courses:{name:e.course.name}})])}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return p()(j.d,{onSubmit:h,gap:32,style:{width:400}},[p()("h2","Add a new Cohort"),"error"===l?p()(O.b,"An error occured"):null,"success"===l?p()(O.c,"Cohort created!"):null,p()(j.e,{gap:8},[p()("h4","Facilitator"),p()(O.g,{required:!0,onChange:function(e){return a(F(F({},n),{},{facilitators:[].concat(Object(c.a)(n.facilitators),[e.currentTarget.value])}))}},[p()("option",{value:""},"Select a facilitator")].concat(Object(c.a)(e.course.course_maintainers.map((function(e){return p()("option",{value:e.maintainer},e.people.display_name||e.people.username)}))||[]))),p()(j.b,{h:!0},n.facilitators.map((function(t){var r=e.course.course_maintainers.find((function(e){return e.maintainer===t}));return r?p()(L.a,{},p()(j.b,{h:!0,gap:4},[p()("p",r.people.display_name||r.people.username),p()(w.d,{onClick:function(e){e.preventDefault(),a(F(F({},n),{},{facilitators:n.facilitators.filter((function(e){return e!==t}))}))}},p()(z.d,{width:10,height:10}))])):null})))]),p()(j.b,{h:!0,gap:32},[p()(j.e,{gap:8},[p()("h4","Start Date"),p()(O.d,{type:"date",placeholder:"yyyy-mm-dd",required:!0,value:n.start_date,onChange:function(e){return a(F(F({},n),{},{start_date:e.currentTarget.value}))}})]),p()(j.e,{gap:8},[p()("h4","Start time (".concat(m,")")),p()(O.d,{type:"time",placeholder:"23:59",required:!0,value:n.start_time,onChange:function(e){return a(F(F({},n),{},{start_time:e.currentTarget.value}))}})])]),p()(w.f,{style:{justifySelf:"right"},status:l,type:"submit",success:"success"===l,disabled:!n.start_date||0===n.facilitators.length},"Add a new Cohort")])},J=function(e){var t=Object(f.useState)(""),n=t[0],a=t[1],c=Object(f.useState)(e.course.invite_only),o=c[0],u=c[1],l=Object(f.useState)(null),d=l[0],m=l[1],h=Object(b.b)([n],(function(){return a("")})),g=Object(s.a)(h,2),y=g[0],v=g[1],S=Object(b.b)([]),k=Object(s.a)(S,2),_=k[0],x=k[1];Object(D.a)(Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.includes("@")&&""!==n){e.next=2;break}return e.abrupt("return",m(null));case 2:return e.next=4,Object(b.a)("/api/get/username/"+n);case 4:404===e.sent.status?m(!1):m(!0);case 6:case"end":return e.stop()}}),e)}))),500,[n]),Object(f.useEffect)((function(){return m(null)}),[n]);var C=function(){var t=Object(i.a)(r.a.mark((function t(a){var c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),c=n.includes("@")?{email:n}:{username:n},v("/api/courses/".concat(e.course.id,"/invite"),F({},c));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=Object(i.a)(r.a.mark((function t(n){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,x("/api/courses/".concat(e.course.id),{invite_only:o});case 3:200===(a=t.sent).status&&e.mutate(F(F({},e.course),a.result));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return p()(j.b,{gap:16,width:400},[p()("h2","Invites"),p()(j.b,{gap:32},[p()(j.d,{onSubmit:E},[p()(j.e,{gap:8,width:400},[p()("div",[p()("h4","Invite Only"),p()("small.textSecondary","Learners cannot enroll in an invite only course unless you have sent them an\ninvite. The invite allows them enroll in any cohort and does not expire.")]),p()(O.a,[p()(O.d,{type:"checkbox",checked:o,onChange:function(e){return u(e.currentTarget.checked)}}),"Make this course invite only"])]),p()(w.f,{style:{justifySelf:"right"},status:_,type:"submit",disabled:e.course.invite_only===o},"Change")]),e.course.invite_only?p()(j.d,{onSubmit:C,gap:32,width:400},[p()(j.e,{gap:8},[p()("h4","Invite someone to enroll"),p()("small.textSecondary","Invite someone with their username or email. Invitee does not need a KrakenEdu account to be invited, but they will need an account to enroll."),p()(O.d,{type:n.includes("@")?"email":"text",value:n,onChange:function(e){return a(e.currentTarget.value)}}),null===d?null:d?p()("span.accentSuccess","Great, found @"+n):p()("span.accentRed","We can't find a user with that username")]),p()(w.f,{style:{justifySelf:"right"},status:y,type:"submit",disabled:!n.includes("@")&&!0!==d},"Invite")]):null])])},K=function(e){var t=Object(D.b)({name:e.course.name,card_image:e.course.card_image,cohort_max_size:e.course.cohort_max_size,description:e.course.description,prerequisites:e.course.prerequisites,cost:e.course.cost,duration:e.course.duration},[e.course]),n=t.state,a=t.form,c=t.changed,o=t.reset,u=t.setState,l=Object(b.b)([]),d=Object(s.a)(l,2),m=d[0],h=d[1],f=function(){var t=Object(i.a)(r.a.mark((function t(a){var c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,h("/api/courses/".concat(e.course.id),F({},n));case 3:200===(c=t.sent).status&&e.mutate(F(F({},e.course),c.result));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return p()(j.d,{onSubmit:f,gap:32,style:{width:400}},[p()("h2","Edit Details"),p()(j.e,{gap:8},[p()("h4","Name"),p()(O.d,F({type:"text",maxLength:50},a.name))]),p()(j.e,{gap:8},[p()("h4","Cost (USD)"),p()(O.d,F({type:"number"},a.cost))]),"course"===e.course.type?null:p()(j.b,[p()("div",[p()("h4","Emojis"),p()("small.textSecondary","Select three emojis to describe your club! Repeats ok.")]),p()(N,{icons:n.card_image.split(","),setIcons:function(e){u(F(F({},n),{},{card_image:e.join(",")}))}})]),p()(j.e,{gap:8},[p()("div",[p()("h4","Cohort Size"),p()("small.textSecondary","How many learners can enroll in a cohort. Set to 0 for no limit.")]),p()(O.d,F({type:"number",required:!0},a.cohort_max_size))]),p()(j.e,{gap:8},[p()("h4","Description"),p()(O.h,F({maxLength:200},a.description))]),p()(j.e,{gap:8},[p()("h4","Prerequisites"),p()(O.h,a.prerequisites)]),p()(j.e,{gap:8},[p()("h4","Duration"),p()(O.d,a.duration)]),p()(W,[p()(w.b,{disabled:!c,onClick:function(e){e.preventDefault(),o()}},"Discard Changes"),p()(w.f,{type:"submit",disabled:!c,status:m},"Save Changes")]),p()(U,e)])};function U(e){var t=Object(f.useState)(""),n=t[0],a=t[1];return p()(j.b,[p()("h3","Maintainers")].concat(Object(c.a)(e.course.course_maintainers.map((function(e){return e.people.display_name||e.people.username}))),[p()("h4","Add a maintainer"),p()(j.d,[p()(O.d,{value:n,onChange:function(e){return a(e.currentTarget.value)}}),p()(w.f,{type:"submit"},"Add")])]))}function G(e){return p()(j.b,{gap:32},[p()(j.b,[p()("p","Each cohort comes with its own community space, and templates to help you populate its structure with topics."),p()("ul",{style:{margin:"auto 0"}},[p()("li",[p()("b","Prepopulated"),p()("span"," topics are automatically posted when each new cohort is created")]),p()("li",[p()("b","Triggered"),p()("span"," topics can be posted by the facilitator from the cohort settings (editable before publishing, so useful for creating multiple topics from one template)")])]),p()("p","You can edit the default templates we've provided below, or add new ones!"),p()(h.a,{href:"/courses/[slug]/[id]/settings/templates/[templateId]",as:"/courses/".concat(e.course.slug,"/").concat(e.course.id,"/settings/templates/new")},p()("a",{},p()(w.f,"+ Add A New Template")))]),p()(j.b,{},e.course.course_templates.sort((function(e,t){return e.name>t.name?1:-1})).sort((function(e){return e.required?-1:1})).flatMap((function(t){return[p()(j.b,{h:!0,style:{gridAutoColumns:"auto"}},[p()("div",[p()("h3",t.name),p()("span.textSecondary","prepopulated"===t.type?"Prepopulated for all cohorts":"Manually published by facilitator")]),p()(j.b,{h:!0,style:{justifySelf:"end",alignItems:"center"}},[t.required?null:p()(V,{course:e.course,mutate:e.mutate,templateName:t.name}),p()(h.a,{href:"/courses/[slug]/[id]/settings/templates/[templateId]",as:"/courses/".concat(e.course.slug,"/").concat(e.course.id,"/settings/templates/").concat(t.name)},p()("a",{},p()(w.g,"Edit")))])]),p()(j.f)]})).slice(0,-1))])}function V(e){var t=Object(f.useState)("normal"),n=t[0],a=t[1],c=Object(b.b)([e]),o=Object(s.a)(c,2),u=o[0],l=o[1];return p()(f.Fragment,[p()(w.b,{onClick:function(){return a("confirm")}},"Delete"),p()(P.a,{display:"normal"!==n,closeText:"nevermind",onExit:function(){return a("normal")}},[p()(j.b,{gap:32,style:{textAlign:"center"}},[p()("h3","Are you sure?"),p()("p","You can't undo this action!"),p()(w.f,{style:{justifySelf:"center"},status:u,onClick:function(){var t=Object(i.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l("/api/courses/".concat(e.course.id,"/templates/").concat(e.templateName),null,"DELETE");case 2:200===t.sent.status&&(e.mutate(F(F({},e.course),{},{course_templates:e.course.course_templates.filter((function(t){return t.name!==e.templateName}))})),a("normal"));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},"Yup delete it")])])])}var W=Object(u.a)("div",{target:"efhwjq20"})({name:"1mxcumu",styles:"justify-self:right;display:grid;grid-template-columns:auto auto;grid-gap:16px;"})},nOkI:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/courses/[slug]/[id]/settings",function(){return n("ECPk")}])}},[["nOkI",0,2,1,3,4,5,7,8,10,11,12,15]]]);
//# sourceMappingURL=settings-b320fbf33c60119d6b78.js.map