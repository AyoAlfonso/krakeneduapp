{"version":3,"sources":["webpack://_N_E/./node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js?deac","webpack://_N_E/./pages/resetPassword.ts"],"names":["window","__NEXT_P","push","COPY","header","button","passwordInput","confirmInput","error","h","Error","Link","href","ResetPassword","useState","password","confirmPassword","formData","setFormData","useApi","status","callResetPassword","router","useRouter","key","query","useEffect","setTimeout","onSubmit","e","a","preventDefault","FormBox","width","ma","LabelBox","gap","PasswordInput","type","minLength","value","onChange","target","Primary","style","justifySelf","Box"],"mappings":"6FACOA,OAAOC,SAAWD,OAAOC,UAAY,IAAIC,KAAK,CAC7C,iBACA,WACE,OAAO,EAAQ,Y,iyBCOzB,IAAMC,EAAO,CACXC,OAAQ,iBACRC,OAAQ,iBACRC,cAAe,eACfC,aAAc,mBACdC,MAAOC,IAAEC,IAAO,CACd,6DAA8DD,IAAEE,IAAM,CAACC,KAAK,gBAAiBH,IAAE,IAAK,wBACpG,YAqDWI,UAjDO,WAAI,MACMC,mBAAS,CAACC,SAAS,GAAIC,gBAAiB,KAAjEC,EADmB,KACTC,EADS,OAEUC,YAA8B,CAACF,IAFzC,mBAEnBG,EAFmB,KAEXC,EAFW,KAGpBC,EAASC,sBACTC,EAAMF,EAAOG,MAAMD,IAUvB,GARAE,qBAAU,WACM,YAAXN,GACDO,YAAW,WACTL,EAAOpB,KAAK,YACX,UAIHsB,GAAsB,kBAARA,EAAkB,OAAOrB,EAAKK,MAEhD,IAAMoB,EAAQ,uCAAG,WAAOC,GAAP,SAAAC,EAAA,6DACfD,EAAEE,iBADa,SAETV,EAAkB,gCAAiC,CAACG,MAAKT,SAAUE,EAASF,WAFnE,2CAAH,sDAKd,OAAOK,GACL,IAAK,SACL,IAAK,UACH,OAAOX,IAAEuB,IAAS,CAACJ,WAAUK,MAAM,IAAKC,IAAI,GAAQ,CAClDzB,IAAE,KAAMN,EAAKC,QACbK,IAAE0B,IAAU,CAACC,IAAK,GAAI,CACpB3B,IAAE,MAAM,CACNA,IAAE,KAAMN,EAAKG,eACbG,IAAE,sBAAuB,iCAE3BA,IAAE4B,IAAe,CACfC,KAAM,WACNC,UAAW,EACXC,MAAOvB,EAASF,SAChB0B,SAAU,SAAAZ,GAAC,OAAIX,EAAY,EAAD,KAAKD,GAAL,IAAeF,SAASc,EAAEa,OAAOF,cAG/D/B,IAAEkC,IAAS,CAACL,KAAM,SAAUlB,SAAQwB,MAAO,CAACC,YAAY,QAAS,YAErE,IAAK,UAAW,OAAOpC,IAAEqC,IAAK,CAC5BrC,IAAE,KAAM,SACRA,IAAE,IAAK,6CACPA,IAAEE,IAAM,CAACC,KAAK,UAAWH,IAAE,IAAKA,IAAEkC,IAAS,cAE7C,IAAK,QAAS,OAAOxC,EAAKK,U","file":"static/chunks/pages/resetPassword-5c111c9ea64d86982342.js","sourcesContent":["\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/resetPassword\",\n        function () {\n          return require(\"private-next-pages/resetPassword.ts\");\n        }\n      ]);\n    ","import h from 'react-hyperscript'\nimport { useState, useEffect } from 'react'\nimport {useRouter} from 'next/router'\nimport Link from 'next/link'\n\nimport { Box, FormBox, LabelBox} from 'components/Layout'\nimport {Primary} from 'components/Button'\nimport { Error, PasswordInput} from 'components/Form'\nimport {ResetMsg, ResetResult} from 'pages/api/user/resetPassword/[action]'\nimport { useApi } from 'src/apiHelpers'\n\nconst COPY = {\n  header: \"Reset Password\",\n  button: \"Reset Password\",\n  passwordInput: \"New Password\",\n  confirmInput: \"Confirm Password\",\n  error: h(Error, [\n    'Looks like that link is expired or invalid, please try to ', h(Link, {href:\"/login?reset\"}, h('a', 'reset your password')),\n    ' again'\n  ])\n}\n\nconst ResetPassword = ()=>{\n  let [formData, setFormData] = useState({password:'', confirmPassword: ''})\n  let [status, callResetPassword] = useApi<ResetMsg, ResetResult>([formData])\n  let router = useRouter()\n  let key = router.query.key as string\n\n  useEffect(()=>{\n    if(status === 'success') {\n      setTimeout(()=> {\n        router.push('/login')\n      }, 3500)\n    }\n  })\n\n  if(!key || typeof key !== 'string') return COPY.error\n\n  const onSubmit = async (e:React.FormEvent)=> {\n    e.preventDefault()\n    await callResetPassword('/api/user/resetPassword/reset', {key, password: formData.password})\n  }\n\n  switch(status) {\n    case 'normal':\n    case 'loading':\n      return h(FormBox, {onSubmit, width:400, ma: true }, [\n        h('h1', COPY.header),\n        h(LabelBox, {gap: 8}, [\n          h('div',[\n            h('h4', COPY.passwordInput),\n            h('small.textSecondary', \"Minimum length 8 characters\"),\n          ]),\n          h(PasswordInput, {\n            type: 'password',\n            minLength: 8,\n            value: formData.password,\n            onChange: e => setFormData({...formData, password:e.target.value})\n          }),\n        ]),\n        h(Primary, {type: 'submit', status, style: {justifySelf:'end'}}, 'Submit')\n      ])\n    case 'success': return h(Box, [\n      h('h1', \"Great\"),\n      h('p', 'You can now log in with your new password'),\n      h(Link, {href:'/login'}, h('a', h(Primary, 'Log In')))\n    ])\n    case 'error': return COPY.error\n  }\n}\n\nexport default ResetPassword\n"],"sourceRoot":""}